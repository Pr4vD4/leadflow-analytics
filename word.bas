Sub СоздатьОтчетПоГОСТ()
    ' Макрос для создания отчета по ГОСТ 7.32-2017
    ' Автор: [Ваше имя]
    ' Дата: [Текущая дата]

    Dim docReport As Document
    Dim rngText As Range

    ' Создание нового документа
    Set docReport = Documents.Add
    Set rngText = docReport.Range

    ' Настройка параметров страницы по ГОСТ 7.32-2017
    With docReport.PageSetup
        .TopMargin = CentimetersToPoints(2)
        .BottomMargin = CentimetersToPoints(2)
        .LeftMargin = CentimetersToPoints(3)
        .RightMargin = CentimetersToPoints(1.5)
        .Orientation = wdOrientPortrait
    End With

    ' Настройка основного стиля текста по ГОСТ
    With rngText.ParagraphFormat
        .LineSpacingRule = wdLineSpace1pt5
        .FirstLineIndent = CentimetersToPoints(1.25)
        .Alignment = wdAlignParagraphJustify
        .SpaceBefore = 0
        .SpaceAfter = 0
    End With

    With rngText.Font
        .Name = "Times New Roman"
        .Size = 14
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
    End With

    ' Настройка стилей заголовков
    НастроитьСтильЗаголовка docReport, "Заголовок 1", 14, True, False, 0, 14
    НастроитьСтильЗаголовка docReport, "Заголовок 2", 14, True, False, 0, 14
    НастроитьСтильЗаголовка docReport, "Заголовок 3", 14, True, False, 0, 14

    ' Создание титульного листа
    СоздатьТитульныйЛист docReport

    ' Создание структуры отчета
    СоздатьСтруктуруОтчета docReport

    ' Добавление нумерации страниц
    ДобавитьНумерациюСтраниц docReport

    ' Создание автоматического оглавления
    СоздатьОглавление docReport

    ' Сообщение об успешном создании отчета
    MsgBox "Отчет по ГОСТ 7.32-2017 успешно создан!", vbInformation
End Sub

Sub НастроитьСтильЗаголовка(docTarget As Document, strStyleName As String, intSize As Integer, blnBold As Boolean, blnItalic As Boolean, intSpaceBefore As Integer, intSpaceAfter As Integer)
    ' Настройка стиля заголовка
    With docTarget.Styles(strStyleName).Font
        .Name = "Times New Roman"
        .Size = intSize
        .Bold = blnBold
        .Italic = blnItalic
    End With

    With docTarget.Styles(strStyleName).ParagraphFormat
        .Alignment = wdAlignParagraphLeft
        .LineSpacingRule = wdLineSpace1pt5
        .SpaceBefore = intSpaceBefore
        .SpaceAfter = intSpaceAfter
        .KeepWithNext = True
        .KeepTogether = True
    End With
End Sub

Sub СоздатьТитульныйЛист(docTarget As Document)
    ' Создание титульного листа по ГОСТ 7.32-2017
    Dim rngTitle As Range

    Set rngTitle = docTarget.Range(0, 0)

    ' Верхний колонтитул организации
    With rngTitle
        .InsertAfter "МИНИСТЕРСТВО НАУКИ И ВЫСШЕГО ОБРАЗОВАНИЯ РОССИЙСКОЙ ФЕДЕРАЦИИ" & vbCr & _
                    "[ПОЛНОЕ НАИМЕНОВАНИЕ УЧЕБНОГО ЗАВЕДЕНИЯ]" & vbCr & _
                    "[НАЗВАНИЕ КАФЕДРЫ/ФАКУЛЬТЕТА]"
        .ParagraphFormat.Alignment = wdAlignParagraphCenter
        .Font.Bold = False
    End With

    ' Перемещение курсора вниз
    rngTitle.Collapse wdCollapseEnd
    rngTitle.InsertAfter vbCr & vbCr & vbCr & vbCr & vbCr & vbCr
    rngTitle.Collapse wdCollapseEnd

    ' Информация об отчете
    With rngTitle
        .InsertAfter "ОТЧЕТ" & vbCr & _
                     "О РАЗРАБОТКЕ СИСТЕМЫ LEADFLOW ANALYTICS" & vbCr & _
                     "[Тип работы: Отчет о производственной практике/НИР и т.д.]"
        .ParagraphFormat.Alignment = wdAlignParagraphCenter
        .Font.Bold = True
    End With

    ' Перемещение курсора вниз
    rngTitle.Collapse wdCollapseEnd
    rngTitle.InsertAfter vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr
    rngTitle.Collapse wdCollapseEnd

    ' Информация об исполнителе
    With rngTitle
        .InsertAfter "Выполнил:" & vbCr & _
                     "[Фамилия И.О., группа]" & vbCr & vbCr & _
                     "Руководитель:" & vbCr & _
                     "[Должность, ученая степень]" & vbCr & _
                     "[Фамилия И.О.]"
        .ParagraphFormat.Alignment = wdAlignParagraphRight
        .Font.Bold = False
    End With

    ' Перемещение курсора в конец страницы
    rngTitle.Collapse wdCollapseEnd
    rngTitle.InsertAfter vbCr & vbCr & vbCr & vbCr & vbCr & vbCr
    rngTitle.Collapse wdCollapseEnd

    ' Город и год
    With rngTitle
        .InsertAfter "[ГОРОД]" & vbCr & _
                     "2024"
        .ParagraphFormat.Alignment = wdAlignParagraphCenter
    End With

    ' Вставка разрыва страницы
    rngTitle.Collapse wdCollapseEnd
    rngTitle.InsertBreak Type:=wdPageBreak
End Sub

Sub ДобавитьНумерациюСтраниц(docTarget As Document)
    ' Добавление нумерации страниц по ГОСТ 7.32-2017
    With docTarget
        ' Первичная настройка колонтитулов
        .PageSetup.DifferentFirstPageHeaderFooter = True

        ' Настройка нижнего колонтитула для нумерации
        If .Sections.Count > 0 Then
            With .Sections(1)
                ' Настройка номеров страниц внизу посередине без номера на первой странице
                With .Footers(wdHeaderFooterPrimary)
                    .Range.ParagraphFormat.Alignment = wdAlignParagraphCenter
                    .Range.Font.Name = "Times New Roman"
                    .Range.Font.Size = 14
                    .Range.Fields.Add Range:=.Range, Type:=wdFieldPage
                End With

                ' Убрать номер на первой странице (титульный лист)
                .Footers(wdHeaderFooterFirstPage).Range.Text = ""
            End With
        End If
    End With
End Sub

Sub СоздатьОглавление(docTarget As Document)
    ' Позиционирование в начало второй страницы (после титульного листа)
    docTarget.Bookmarks("\StartOfDoc").Range.Select
    Selection.GoTo What:=wdGoToPage, Which:=wdGoToNext

    ' Вставка заголовка "СОДЕРЖАНИЕ"
    Selection.TypeText "СОДЕРЖАНИЕ"
    Selection.TypeParagraph
    Selection.TypeParagraph

    ' Форматирование заголовка содержания
    docTarget.Paragraphs(docTarget.Paragraphs.Count - 2).Range.ParagraphFormat.Alignment = wdAlignParagraphCenter
    docTarget.Paragraphs(docTarget.Paragraphs.Count - 2).Range.Font.Bold = True

    ' Вставка оглавления
    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldTOC, Text:= _
        "TOC \o ""1-3"" \h \z \u", PreserveFormatting:=True

    ' Вставка разрыва страницы после оглавления
    Selection.EndOf Unit:=wdStory
    Selection.InsertBreak Type:=wdPageBreak
End Sub

Sub СоздатьСтруктуруОтчета(docTarget As Document)
    ' Позиционирование после оглавления
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Введение
    ДобавитьЗаголовок docTarget, "ВВЕДЕНИЕ", 1, False

    ' Добавление содержимого для введения
    ДобавитьСодержимоеВведения docTarget

    ' Раздел 1
    ДобавитьЗаголовок docTarget, "1 АНАЛИЗ ДЕЯТЕЛЬНОСТИ ПРЕДПРИЯТИЯ", 1, True
    ДобавитьЗаголовок docTarget, "1.1 Общая характеристика предприятия", 2, True

    ' Добавление содержимого раздела 1.1
    ДобавитьСодержимоеХарактеристикаПредприятия docTarget

    ДобавитьЗаголовок docTarget, "1.2 Анализ бизнес-процессов по работе с клиентскими заявками", 2, True

    ' Добавление содержимого раздела 1.2
    ДобавитьСодержимоеАнализБизнесПроцессов docTarget

    ДобавитьЗаголовок docTarget, "1.3 Выявленные проблемы в текущих бизнес-процессах", 2, True

    ' Добавление содержимого раздела 1.3
    ДобавитьСодержимоеПроблемыБизнесПроцессов docTarget

    ДобавитьЗаголовок docTarget, "1.4 Обоснование необходимости разработки системы LeadFlow Analytics", 2, True

    ' Добавление содержимого раздела 1.4
    ДобавитьСодержимоеОбоснованиеРазработки docTarget

    ДобавитьЗаголовок docTarget, "1.5 Требования к разрабатываемой системе", 2, True

    ' Добавление содержимого раздела 1.5
    ДобавитьСодержимоеТребованияКСистеме docTarget

    ' Раздел 2
    ДобавитьЗаголовок docTarget, "2 РЕАЛИЗАЦИЯ ЗАДАНИЙ, ПОЛУЧЕННЫХ ОТ РУКОВОДИТЕЛЯ ПРЕДПРИЯТИЯ", 1, True
    ДобавитьЗаголовок docTarget, "2.1 Архитектура разработанной системы", 2, True
    ДобавитьЗаголовок docTarget, "2.1.1 Серверная часть (Laravel Framework)", 3, True
    ДобавитьТекстЗаглушку docTarget, "Описание архитектуры серверной части..."

    ДобавитьЗаголовок docTarget, "2.1.2 Клиентская часть (Livewire, Blade)", 3, True
    ДобавитьТекстЗаглушку docTarget, "Описание архитектуры клиентской части..."

    ДобавитьЗаголовок docTarget, "2.1.3 База данных и схема данных", 3, True
    ДобавитьТекстЗаглушку docTarget, "Описание структуры базы данных и схемы данных..."

    ДобавитьЗаголовок docTarget, "2.2 Реализация интеграционного модуля", 2, True

    ' Добавление содержимого раздела 2.2
    ДобавитьСодержимоеИнтеграционныйМодуль docTarget

    ДобавитьЗаголовок docTarget, "2.2.1 API для приема заявок", 3, True

    ' Добавление содержимого раздела 2.2.1
    ДобавитьСодержимоеAPIЗаявок docTarget

    ДобавитьЗаголовок docTarget, "2.2.2 Механизм авторизации и аутентификации", 3, True

    ' Добавление содержимого раздела 2.2.2
    ДобавитьСодержимоеМеханизмАвторизации docTarget

    ДобавитьЗаголовок docTarget, "2.3 Разработка мини-CRM модуля", 2, True

    ' Добавление содержимого раздела 2.3
    ДобавитьСодержимоеМиниCRM docTarget

    ДобавитьЗаголовок docTarget, "2.3.1 Структура и компоненты мини-CRM", 3, True

    ' Добавление содержимого раздела 2.3.1
    ДобавитьСодержимоеСтруктураCRM docTarget

    ДобавитьЗаголовок docTarget, "2.3.2 Функциональные возможности мини-CRM", 3, True

    ' Добавление содержимого раздела 2.3.2
    ДобавитьСодержимоеФункцииCRM docTarget

    ДобавитьЗаголовок docTarget, "2.3.3 Интерфейс пользователя мини-CRM", 3, True

    ' Добавление содержимого раздела 2.3.3
    ДобавитьСодержимоеИнтерфейсCRM docTarget

    ДобавитьЗаголовок docTarget, "2.4 Реализация ИИ-аналитики", 2, True

    ' Добавление содержимого раздела 2.4
    ДобавитьСодержимоеИИАналитика docTarget

    ДобавитьЗаголовок docTarget, "2.5 Разработка дашборда аналитики", 2, True

    ' Добавление содержимого раздела 2.5
    ДобавитьСодержимоеДашбордАналитики docTarget

    ДобавитьЗаголовок docTarget, "2.6 Интеграция с внешними системами", 2, True

    ' Добавление содержимого раздела 2.6
    ДобавитьСодержимоеИнтеграцияВнешниеСистемы docTarget

    ДобавитьЗаголовок docTarget, "2.7 Внедрение и тестирование системы", 2, True

    ' Добавление содержимого раздела 2.7
    ДобавитьСодержимоеВнедрениеТестирование docTarget

    ' Заключение
    ДобавитьЗаголовок docTarget, "ЗАКЛЮЧЕНИЕ", 1, False
    ДобавитьТекстЗаглушку docTarget, _
    "В данном разделе описываются основные результаты разработки, " & _
    "оценка эффективности внедрения и перспективы развития системы. " & _
    "Рекомендуемый объем: 2-3 страницы."

    ' Список использованных источников
    ДобавитьЗаголовок docTarget, "СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ", 1, False

    ' Добавление примеров источников
    docTarget.Bookmarks("\EndOfDoc").Range.Select
    Selection.TypeText "1. ГОСТ 7.32-2017 Система стандартов по информации, библиотечному и издательскому делу. Отчет о научно-исследовательской работе. Структура и правила оформления"
    Selection.TypeParagraph
    Selection.TypeText "2. Laravel – The PHP Framework for Web Artisans. [Электронный ресурс] – Режим доступа: https://laravel.com/docs/"
    Selection.TypeParagraph
    Selection.TypeText "3. OpenAI API Documentation. [Электронный ресурс] – Режим доступа: https://platform.openai.com/docs/"
    Selection.TypeParagraph
    Selection.TypeText "4. Livewire Documentation. [Электронный ресурс] – Режим доступа: https://laravel-livewire.com/"
    Selection.TypeParagraph
    Selection.TypeText "5. Bitrix24 REST API Documentation. [Электронный ресурс] – Режим доступа: https://dev.1c-bitrix.ru/rest_help/"

    ' Форматирование списка источников
    docTarget.Bookmarks("\EndOfDoc").Range.Paragraphs.Last.Range.ParagraphFormat.SpaceAfter = 6
    docTarget.Bookmarks("\EndOfDoc").Range.Paragraphs.Last.Range.ParagraphFormat.SpaceBefore = 6
    docTarget.Bookmarks("\EndOfDoc").Range.Paragraphs.Last.Range.ParagraphFormat.LeftIndent = CentimetersToPoints(1.25)
    docTarget.Bookmarks("\EndOfDoc").Range.Paragraphs.Last.Range.ParagraphFormat.FirstLineIndent = CentimetersToPoints(-1.25)
End Sub

Sub ДобавитьЗаголовок(docTarget As Document, strHeadingText As String, intLevel As Integer, blnAddPageBreak As Boolean)
    ' Добавление заголовка с соответствующим уровнем
    Dim strStyleName As String

    ' Определение стиля в зависимости от уровня
    strStyleName = "Заголовок " & intLevel

    ' Вставка разрыва страницы перед заголовком, если необходимо
    If blnAddPageBreak Then
        docTarget.Bookmarks("\EndOfDoc").Range.InsertBreak Type:=wdPageBreak
    End If

    ' Вставка заголовка
    docTarget.Bookmarks("\EndOfDoc").Range.Select
    Selection.TypeText strHeadingText
    Selection.TypeParagraph

    ' Применение стиля к заголовку
    docTarget.Paragraphs(docTarget.Paragraphs.Count - 1).Range.Style = strStyleName
End Sub

Sub ДобавитьТекстЗаглушку(docTarget As Document, strText As String)
    ' Добавление текста-заглушки с базовым форматированием
    docTarget.Bookmarks("\EndOfDoc").Range.Select
    Selection.TypeText strText
    Selection.TypeParagraph
    Selection.TypeParagraph
End Sub

' Дополнительная функция для добавления пустого списка
Sub ДобавитьПустойСписок(docTarget As Document, intCount As Integer)
    Dim i As Integer

    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Создание маркированного списка
    Selection.Range.ListFormat.ApplyBulletDefault

    ' Добавление пунктов списка
    For i = 1 To intCount
        Selection.TypeText "Пункт списка " & i
        If i < intCount Then Selection.TypeParagraph
    Next i

    ' Завершение списка
    Selection.TypeParagraph
    Selection.Range.ListFormat.RemoveNumbers
End Sub

' Дополнительная функция для добавления рисунка-заглушки
Sub ДобавитьРисунокЗаглушку(docTarget As Document, strCaption As String)
    ' Добавление рисунка-заглушки
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Здесь можно вставить реальный рисунок, если он доступен
    ' Selection.InlineShapes.AddPicture FileName:="path_to_image.jpg", LinkToFile:=False, SaveWithDocument:=True

    ' Вместо этого добавим текстовую заглушку
    Selection.TypeText "[Место для рисунка: " & strCaption & "]"
    Selection.TypeParagraph

    ' Добавление подписи к рисунку
    Selection.TypeText "Рисунок X.X - " & strCaption
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.TypeParagraph
    Selection.ParagraphFormat.Alignment = wdAlignParagraphJustify
End Sub

' Дополнительная функция для добавления таблицы-заглушки
Sub ДобавитьТаблицуЗаглушку(docTarget As Document, strCaption As String, intRows As Integer, intCols As Integer)
    ' Добавление таблицы-заглушки
    Dim tbl As Table
    Dim i As Integer, j As Integer

    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Создание таблицы
    Set tbl = docTarget.Tables.Add(Range:=Selection.Range, NumRows:=intRows, NumColumns:=intCols)

    ' Добавление данных в таблицу
    For i = 1 To intRows
        For j = 1 To intCols
            tbl.Cell(i, j).Range.Text = "Ячейка " & i & "," & j
        Next j
    Next i

    ' Форматирование таблицы
    tbl.Borders.Enable = True
    tbl.AutoFormat Format:=wdTableFormatSimple1

    ' Добавление подписи к таблице
    Selection.EndOf Unit:=wdStory
    Selection.TypeParagraph
    Selection.TypeText "Таблица X.X - " & strCaption
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.TypeParagraph
    Selection.ParagraphFormat.Alignment = wdAlignParagraphJustify
End Sub

' Новая функция для добавления содержимого введения
Sub ДобавитьСодержимоеВведения(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textВведение As String

    textВведение = "Данный отчет представляет собой документацию по результатам прохождения производственной " & _
                  "практики в компании, специализирующейся на разработке программного обеспечения в сфере " & _
                  "автоматизации бизнес-процессов. В рамках практики был реализован проект LeadFlow Analytics " & _
                  "– информационная система для сбора, анализа и автоматизации обработки клиентских заявок " & _
                  "с интеграцией в CRM-системы и применением технологий искусственного интеллекта." & vbCr & vbCr

    textВведение = textВведение & _
                  "Актуальность разработки системы LeadFlow Analytics обусловлена растущей потребностью " & _
                  "современных предприятий в эффективных инструментах обработки клиентских обращений. " & _
                  "В условиях высокой конкуренции качество и скорость обработки заявок напрямую влияют на " & _
                  "конверсию продаж и удовлетворенность клиентов. Автоматизация этих процессов позволяет " & _
                  "значительно повысить эффективность работы менеджеров, сократить время обработки заявок и " & _
                  "улучшить клиентский опыт." & vbCr & vbCr

    textВведение = textВведение & _
                  "Целью практики является разработка минимально жизнеспособного продукта (MVP) системы " & _
                  "LeadFlow Analytics, обладающего базовым функционалом для сбора заявок, их анализа с " & _
                  "применением искусственного интеллекта, управления процессом обработки и интеграции с " & _
                  "внешними системами." & vbCr & vbCr

    textВведение = textВведение & _
                  "Задачи, решаемые в рамках практики:" & vbCr

    Selection.TypeText textВведение

    ' Добавление списка задач
    ДобавитьНумерованныйСписок docTarget, Array( _
        "Анализ требований к системе и проектирование архитектуры.", _
        "Разработка интеграционного модуля для приема заявок через REST API.", _
        "Создание мини-CRM для управления заявками, включая систему статусов и тегов.", _
        "Реализация модуля ИИ-аналитики с использованием технологий обработки естественного языка.", _
        "Разработка дашборда для визуализации аналитики и ключевых метрик.", _
        "Интеграция с внешними системами (Bitrix24, Telegram).", _
        "Тестирование и оптимизация производительности системы.")

    ' Добавление текста после списка
    textВведение = vbCr & _
                  "В качестве технологической базы для разработки системы LeadFlow Analytics был выбран " & _
                  "современный PHP-фреймворк Laravel 10, обеспечивающий надежную инфраструктуру для создания " & _
                  "веб-приложений. Фреймворк предоставляет широкие возможности для реализации API, работы с " & _
                  "базами данных, обеспечения безопасности и построения пользовательского интерфейса." & vbCr & vbCr & _
                  "В процессе разработки использовались современные методологии и подходы к созданию программного " & _
                  "обеспечения, включая агильную разработку, объектно-ориентированное программирование и " & _
                  "тестирование. Особое внимание уделялось аспектам безопасности, производительности и " & _
                  "масштабируемости системы." & vbCr & vbCr & _
                  "Данный отчет содержит подробное описание процесса разработки системы LeadFlow Analytics, " & _
                  "анализ деятельности предприятия, техническую документацию по реализованным модулям, а также " & _
                  "результаты тестирования и оценку эффективности внедрения системы."

    Selection.TypeText textВведение
    Selection.TypeParagraph
End Sub

' Функция для добавления нумерованного списка
Sub ДобавитьНумерованныйСписок(docTarget As Document, items As Variant)
    Dim i As Integer

    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Создание нумерованного списка
    Selection.Range.ListFormat.ApplyNumberDefault

    ' Добавление пунктов списка
    For i = LBound(items) To UBound(items)
        Selection.TypeText items(i)
        If i < UBound(items) Then Selection.TypeParagraph
    Next i

    ' Завершение списка
    Selection.TypeParagraph
    Selection.Range.ListFormat.RemoveNumbers
End Sub

' Функция для добавления содержимого раздела "Общая характеристика предприятия"
Sub ДобавитьСодержимоеХарактеристикаПредприятия(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textХарактеристика As String

    textХарактеристика = "Компания ООО «ТехноСофт» специализируется на разработке программного обеспечения для " & _
                       "автоматизации бизнес-процессов и является активным участником российского ИТ-рынка. " & _
                       "Основными направлениями деятельности компании являются:" & vbCr

    Selection.TypeText textХарактеристика

    ' Добавление маркированного списка направлений деятельности
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Разработка и внедрение CRM-систем", _
        "Создание веб-приложений и корпоративных порталов", _
        "Интеграция программных решений с внешними системами", _
        "Разработка мобильных приложений для бизнеса", _
        "Консалтинг в области цифровой трансформации бизнеса")

    ' Добавление текста после списка
    textХарактеристика = "Компания была основана в 2015 году и за время своего существования реализовала более " & _
                       "50 успешных проектов для клиентов из различных отраслей: розничной торговли, сферы услуг, " & _
                       "строительства и производства. Штат компании насчитывает 35 сотрудников, среди которых " & _
                       "программисты, аналитики, тестировщики и специалисты по внедрению." & vbCr & vbCr & _
                       "Организационная структура компании имеет матричный тип и включает следующие отделы:" & vbCr

    Selection.TypeText textХарактеристика

    ' Добавление списка отделов компании
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отдел разработки (frontend и backend-разработчики, мобильные разработчики)", _
        "Отдел аналитики и проектирования", _
        "Отдел тестирования и контроля качества", _
        "Отдел внедрения и технической поддержки", _
        "Отдел продаж и маркетинга", _
        "Административный отдел")

    ' Добавление текста после списка
    textХарактеристика = "Компания использует современную технологическую инфраструктуру, включающую системы " & _
                       "контроля версий, CI/CD-конвейеры, системы мониторинга и автоматизированного тестирования. " & _
                       "Разработка ведется по гибким методологиям (Scrum, Kanban) с использованием инструментов " & _
                       "управления проектами Jira и Confluence." & vbCr & vbCr & _
                       "Миссия компании – создание эффективных программных решений, помогающих бизнесу клиентов " & _
                       "развиваться и адаптироваться к меняющимся условиям рынка. Компания придерживается " & _
                       "принципов клиентоориентированности, инновационности и качества разработки." & vbCr & vbCr & _
                       "Финансовое положение компании стабильное, с ежегодным ростом выручки в среднем на 20-25%. " & _
                       "Основные источники дохода – реализация программных продуктов, внедрение решений и " & _
                       "техническая поддержка внедренных систем." & vbCr & vbCr & _
                       "Компания активно следит за трендами в сфере информационных технологий и внедряет " & _
                       "инновационные решения, включая технологии искусственного интеллекта, машинного обучения " & _
                       "и облачных вычислений, что позволяет ей оставаться конкурентоспособной на рынке " & _
                       "разработки программного обеспечения."

    Selection.TypeText textХарактеристика
    Selection.TypeParagraph
End Sub

' Функция для добавления маркированного списка
Sub ДобавитьМаркированныйСписок(docTarget As Document, items As Variant)
    Dim i As Integer

    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Создание маркированного списка
    Selection.Range.ListFormat.ApplyBulletDefault

    ' Добавление пунктов списка
    For i = LBound(items) To UBound(items)
        Selection.TypeText items(i)
        If i < UBound(items) Then Selection.TypeParagraph
    Next i

    ' Завершение списка
    Selection.TypeParagraph
    Selection.Range.ListFormat.RemoveNumbers
End Sub

' Функция для добавления содержимого раздела "Анализ бизнес-процессов по работе с клиентскими заявками"
Sub ДобавитьСодержимоеАнализБизнесПроцессов(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textАнализ As String

    textАнализ = "В ходе прохождения практики был проведен анализ бизнес-процессов компании, связанных с " & _
               "обработкой клиентских заявок. Анализ включал изучение документации, интервьюирование " & _
               "сотрудников и наблюдение за рабочими процессами." & vbCr & vbCr & _
               "Процесс обработки клиентских заявок до внедрения системы LeadFlow Analytics состоял " & _
               "из следующих этапов:" & vbCr

    Selection.TypeText textАнализ

    ' Добавление нумерованного списка этапов обработки заявок
    ДобавитьНумерованныйСписок docTarget, Array( _
        "Получение заявки через различные каналы (веб-формы на сайте, электронная почта, телефонные звонки, мессенджеры).", _
        "Ручная регистрация заявки менеджером в CRM-системе Bitrix24.", _
        "Первичная обработка и категоризация заявки.", _
        "Назначение ответственного сотрудника.", _
        "Коммуникация с клиентом для уточнения деталей запроса.", _
        "Подготовка ответа или коммерческого предложения.", _
        "Отправка ответа клиенту.", _
        "Отслеживание статуса заявки и дальнейшее взаимодействие.", _
        "Закрытие заявки и фиксация результата.")

    ' Добавление текста после списка
    textАнализ = "Анализ существующего процесса обработки заявок выявил следующие особенности и характеристики:" & vbCr

    Selection.TypeText textАнализ

    ' Добавление маркированного списка особенностей процесса
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Среднее время обработки заявки от момента получения до первого ответа клиенту составляет 4-6 часов.", _
        "Ежедневно компания обрабатывает в среднем 30-40 заявок.", _
        "Распределение заявок по каналам поступления: 60% – веб-формы на сайте, 25% – электронная почта, 10% – телефонные звонки, 5% – мессенджеры.", _
        "Конверсия заявок в продажи составляет около 18%.", _
        "Наиболее распространенные категории заявок: запрос коммерческого предложения (40%), техническая поддержка (30%), общие вопросы (20%), партнерские предложения (10%).")

    ' Добавление текста после списка
    textАнализ = "Для визуализации процесса обработки заявок была составлена блок-схема, отражающая основные " & _
               "этапы и принятие решений (Рисунок 1.1)." & vbCr & vbCr

    Selection.TypeText textАнализ

    ' Добавление рисунка-заглушки для блок-схемы
    ДобавитьРисунокЗаглушку docTarget, "Блок-схема процесса обработки клиентских заявок"

    ' Продолжение текста
    textАнализ = "Процессы взаимодействия между отделами при обработке заявок организованы следующим образом:" & vbCr & vbCr & _
               "1. Отдел продаж является первичным получателем и обработчиком заявок. Менеджеры отдела " & _
               "регистрируют заявки в CRM-системе, проводят первичную категоризацию и отвечают за коммуникацию " & _
               "с клиентами." & vbCr & vbCr & _
               "2. Отдел аналитики привлекается к обработке сложных заявок, требующих детального изучения " & _
               "потребностей клиента и подготовки индивидуальных решений." & vbCr & vbCr & _
               "3. Технический отдел участвует в обработке заявок, связанных с технической поддержкой, " & _
               "консультациями по интеграции или другими техническими вопросами." & vbCr & vbCr & _
               "4. Отдел маркетинга анализирует заявки для оценки эффективности рекламных кампаний и источников " & _
               "привлечения клиентов." & vbCr & vbCr & _
               "Информационные потоки при обработке заявок реализованы с использованием нескольких систем: " & _
               "Bitrix24 для управления взаимоотношениями с клиентами, корпоративная электронная почта, " & _
               "корпоративный мессенджер и справочная система." & vbCr & vbCr & _
               "Для оценки эффективности процессов используются следующие ключевые показатели:" & vbCr

    Selection.TypeText textАнализ

    ' Добавление маркированного списка KPI
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Среднее время обработки заявки", _
        "Конверсия заявок в продажи", _
        "Удовлетворенность клиентов (по результатам опросов)", _
        "Количество обработанных заявок на одного менеджера", _
        "Процент повторных обращений")

    ' Добавление текста после списка
    textАнализ = "Данные показатели отслеживаются на ежемесячной основе и используются для оценки " & _
               "эффективности работы отдела продаж и качества обслуживания клиентов." & vbCr & vbCr & _
               "Таким образом, проведенный анализ бизнес-процессов по работе с клиентскими заявками " & _
               "позволил выявить особенности существующей системы обработки заявок и стал основой для " & _
               "выявления проблемных мест и разработки требований к новой системе LeadFlow Analytics."

    Selection.TypeText textАнализ
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Выявленные проблемы в текущих бизнес-процессах"
Sub ДобавитьСодержимоеПроблемыБизнесПроцессов(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textПроблемы As String

    textПроблемы = "На основе проведенного анализа бизнес-процессов по работе с клиентскими заявками был " & _
                 "выявлен ряд проблем и недостатков в существующей системе обработки заявок:" & vbCr

    Selection.TypeText textПроблемы

    ' Добавление маркированного списка проблем
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Ручной ввод данных заявок в CRM-систему – приводит к высоким временным затратам, ошибкам ввода и задержкам в обработке.", _
        "Отсутствие единого источника получения заявок – заявки поступают через различные каналы без автоматической консолидации.", _
        "Несистематизированная обработка и категоризация заявок – отсутствие стандартизированного подхода к анализу и классификации.", _
        "Ограниченные возможности аналитики – сложность получения детальной статистики по конверсии, источникам заявок и эффективности работы менеджеров.", _
        "Отсутствие автоматизированных уведомлений – необходимость ручного контроля статусов заявок.", _
        "Субъективная оценка приоритетности заявок – зависимость от личного восприятия менеджера без использования объективных критериев.", _
        "Отсутствие автоматизированной генерации ответов на типовые запросы – увеличение времени обработки стандартных заявок.", _
        "Сложность отслеживания эффективности рекламных кампаний – отсутствие связи между источниками привлечения и конверсией в продажи.")

    ' Добавление текста после списка
    textПроблемы = "Количественная оценка выявленных проблем представлена в таблице 1.1, где отражено негативное " & _
                 "влияние каждой проблемы на ключевые показатели эффективности бизнес-процессов." & vbCr & vbCr

    Selection.TypeText textПроблемы

    ' Добавление таблицы с оценкой проблем
    ДобавитьТаблицуКоличественнаяОценкаПроблем docTarget

    ' Продолжение текста
    textПроблемы = "Проведенный анализ также выявил, что существующие проблемы имеют следующие негативные последствия " & _
                 "для бизнеса компании:" & vbCr & vbCr & _
                 "1. Увеличение операционных расходов – неэффективное использование рабочего времени сотрудников " & _
                 "на ручные операции вместо решения более сложных задач." & vbCr & vbCr & _
                 "2. Снижение уровня клиентского сервиса – задержки в ответах и неперсонализированные коммуникации " & _
                 "негативно влияют на восприятие компании клиентами." & vbCr & vbCr & _
                 "3. Упущенные возможности продаж – несвоевременная обработка заявок приводит к потере потенциальных клиентов." & vbCr & vbCr & _
                 "4. Неэффективное распределение маркетингового бюджета – сложность отслеживания эффективности различных " & _
                 "каналов привлечения клиентов затрудняет оптимизацию маркетинговых инвестиций." & vbCr & vbCr & _
                 "Выявленные проблемы свидетельствуют о необходимости внедрения автоматизированной системы, " & _
                 "способной объединить все источники получения заявок, автоматизировать их первичную обработку " & _
                 "и анализ, а также обеспечить интеграцию с существующей CRM-системой Bitrix24."

    Selection.TypeText textПроблемы
    Selection.TypeParagraph
End Sub

' Функция для добавления таблицы с количественной оценкой проблем
Sub ДобавитьТаблицуКоличественнаяОценкаПроблем(docTarget As Document)
    Dim tbl As Table

    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Создание таблицы
    Set tbl = docTarget.Tables.Add(Range:=Selection.Range, NumRows:=4, NumColumns:=3)

    ' Форматирование таблицы
    With tbl
        .Borders.Enable = True
        .Rows(1).HeadingFormat = True
        .Cell(1, 1).Range.Text = "Проблема"
        .Cell(1, 2).Range.Text = "Количественная оценка"
        .Cell(1, 3).Range.Text = "Влияние на эффективность"

        .Cell(2, 1).Range.Text = "Ручной ввод данных в CRM"
        .Cell(2, 2).Range.Text = "Затраты 15-20 минут на одну заявку"
        .Cell(2, 3).Range.Text = "Снижение продуктивности на 25%"

        .Cell(3, 1).Range.Text = "Отсутствие автоматической категоризации"
        .Cell(3, 2).Range.Text = "Ошибки категоризации в 30% случаев"
        .Cell(3, 3).Range.Text = "Увеличение времени обработки на 40%"

        .Cell(4, 1).Range.Text = "Несистематизированная аналитика"
        .Cell(4, 2).Range.Text = "8 часов в неделю на подготовку отчетов"
        .Cell(4, 3).Range.Text = "Задержки в принятии управленческих решений"

        .AutoFormat Format:=wdTableFormatSimple1
    End With

    ' Добавление подписи к таблице
    Selection.EndOf Unit:=wdStory
    Selection.TypeParagraph
    Selection.TypeText "Таблица 1.1 – Количественная оценка проблем в процессе обработки заявок"
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.TypeParagraph
    Selection.ParagraphFormat.Alignment = wdAlignParagraphJustify
End Sub

' Функция для добавления содержимого раздела "Обоснование необходимости разработки системы"
Sub ДобавитьСодержимоеОбоснованиеРазработки(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textОбоснование As String

    textОбоснование = "Выявленные в ходе анализа проблемы в существующих бизнес-процессах обработки клиентских " & _
                    "заявок обуславливают необходимость разработки и внедрения специализированной системы " & _
                    "LeadFlow Analytics. Обоснование необходимости создания системы можно представить с нескольких " & _
                    "точек зрения:" & vbCr & vbCr & _
                    "С экономической точки зрения:" & vbCr

    Selection.TypeText textОбоснование

    ' Добавление маркированного списка экономических факторов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Сокращение операционных затрат – автоматизация рутинных операций позволит снизить трудозатраты на обработку заявок на 40-50%.", _
        "Повышение конверсии заявок в продажи – оперативная обработка и релевантные ответы могут увеличить конверсию с 18% до 25-30%.", _
        "Оптимизация маркетингового бюджета – анализ эффективности каналов привлечения позволит перераспределить бюджет в пользу наиболее результативных источников.", _
        "Сокращение времени на подготовку аналитических отчетов – автоматизация формирования отчетов сэкономит до 8 часов рабочего времени еженедельно.")

    ' Добавление текста после списка
    textОбоснование = "С технологической точки зрения:" & vbCr

    Selection.TypeText textОбоснование

    ' Добавление маркированного списка технологических факторов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Консолидация данных из различных источников – создание единой точки сбора и обработки заявок.", _
        "Интеграция с существующими системами – бесшовное взаимодействие с CRM Bitrix24 без необходимости миграции данных.", _
        "Применение современных технологий ИИ для автоматизации аналитических процессов – использование алгоритмов обработки естественного языка для категоризации и анализа заявок.", _
        "Возможность масштабирования системы в соответствии с ростом бизнеса – архитектура, позволяющая добавлять новые функции и увеличивать нагрузку.")

    ' Добавление текста после списка
    textОбоснование = "С точки зрения клиентского опыта:" & vbCr

    Selection.TypeText textОбоснование

    ' Добавление маркированного списка факторов клиентского опыта
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Сокращение времени ответа на заявки – повышение удовлетворенности клиентов и вероятности совершения сделки.", _
        "Персонализация коммуникаций – использование данных о клиенте для формирования индивидуальных ответов.", _
        "Повышение качества обработки заявок – снижение количества ошибок и недопониманий.", _
        "Проактивный подход к взаимодействию с клиентами – автоматические уведомления и отслеживание статусов заявок.")

    ' Добавление текста после списка
    textОбоснование = "Оценка потенциального экономического эффекта от внедрения системы LeadFlow Analytics " & _
                    "представлена в таблице 1.2." & vbCr & vbCr

    Selection.TypeText textОбоснование

    ' Добавление таблицы с оценкой экономического эффекта
    ДобавитьТаблицуЭкономическийЭффект docTarget

    ' Продолжение текста
    textОбоснование = "Результаты предварительной оценки показывают, что внедрение системы LeadFlow Analytics " & _
                    "позволит компании достичь следующих результатов:" & vbCr & vbCr & _
                    "1. Сократить время обработки заявок на 60%, что позволит обрабатывать больший объем заявок " & _
                    "без увеличения штата сотрудников." & vbCr & vbCr & _
                    "2. Увеличить конверсию заявок в продажи на 7-12 процентных пунктов благодаря оперативной " & _
                    "и качественной обработке." & vbCr & vbCr & _
                    "3. Повысить точность категоризации заявок до 90%, что обеспечит более эффективное распределение " & _
                    "ресурсов и приоритизацию работы с клиентами." & vbCr & vbCr & _
                    "4. Обеспечить полную прозрачность и контроль процесса обработки заявок для руководства компании." & vbCr & vbCr & _
                    "Таким образом, разработка системы LeadFlow Analytics является обоснованным решением, способным " & _
                    "существенно повысить эффективность бизнес-процессов компании и обеспечить конкурентное преимущество " & _
                    "на рынке."

    Selection.TypeText textОбоснование
    Selection.TypeParagraph
End Sub

' Функция для добавления таблицы с оценкой экономического эффекта
Sub ДобавитьТаблицуЭкономическийЭффект(docTarget As Document)
    Dim tbl As Table

    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Создание таблицы
    Set tbl = docTarget.Tables.Add(Range:=Selection.Range, NumRows:=5, NumColumns:=3)

    ' Форматирование таблицы
    With tbl
        .Borders.Enable = True
        .Rows(1).HeadingFormat = True
        .Cell(1, 1).Range.Text = "Показатель"
        .Cell(1, 2).Range.Text = "Текущее значение"
        .Cell(1, 3).Range.Text = "Прогнозируемое значение после внедрения"

        .Cell(2, 1).Range.Text = "Среднее время обработки заявки"
        .Cell(2, 2).Range.Text = "4-6 часов"
        .Cell(2, 3).Range.Text = "1,5-2 часа"

        .Cell(3, 1).Range.Text = "Конверсия заявок в продажи"
        .Cell(3, 2).Range.Text = "18%"
        .Cell(3, 3).Range.Text = "25-30%"

        .Cell(4, 1).Range.Text = "Трудозатраты на аналитику и отчетность"
        .Cell(4, 2).Range.Text = "8 часов в неделю"
        .Cell(4, 3).Range.Text = "1,5-2 часа в неделю"

        .Cell(5, 1).Range.Text = "Точность категоризации заявок"
        .Cell(5, 2).Range.Text = "60-70%"
        .Cell(5, 3).Range.Text = "90% и выше"

        .AutoFormat Format:=wdTableFormatSimple1
    End With

    ' Добавление подписи к таблице
    Selection.EndOf Unit:=wdStory
    Selection.TypeParagraph
    Selection.TypeText "Таблица 1.2 – Оценка экономического эффекта от внедрения системы LeadFlow Analytics"
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.TypeParagraph
    Selection.ParagraphFormat.Alignment = wdAlignParagraphJustify
End Sub

' Функция для добавления содержимого раздела "Требования к разрабатываемой системе"
Sub ДобавитьСодержимоеТребованияКСистеме(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textТребования As String

    textТребования = "На основе анализа бизнес-процессов и выявленных проблем были сформулированы требования " & _
                   "к разрабатываемой системе LeadFlow Analytics. Требования структурированы по функциональным " & _
                   "модулям системы и охватывают различные аспекты её работы." & vbCr & vbCr & _
                   "Функциональные требования к интеграционному модулю:" & vbCr

    Selection.TypeText textТребования

    ' Добавление маркированного списка требований к интеграционному модулю
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Наличие REST API для приема заявок с веб-сайтов и других источников в формате JSON.", _
        "Обеспечение аутентификации через API-ключи для безопасного доступа.", _
        "Поддержка обязательных полей: источник заявки, контактная информация (email или телефон).", _
        "Поддержка дополнительных полей: имя, сообщение, произвольные поля.", _
        "Валидация входящих данных с детализированными сообщениями об ошибках.", _
        "Реализация механизма мультитенантности для разделения данных между клиентами системы.", _
        "Обеспечение асинхронной обработки заявок при пиковых нагрузках.")

    ' Добавление текста после списка
    textТребования = "Функциональные требования к мини-CRM модулю:" & vbCr

    Selection.TypeText textТребования

    ' Добавление маркированного списка требований к мини-CRM
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отображение списка заявок с возможностью фильтрации по статусу, источнику, дате и другим параметрам.", _
        "Наличие системы статусов заявок (Новая, В работе, Завершена, Архив).", _
        "Поддержка тегирования заявок для их дополнительной категоризации.", _
        "Возможность загрузки и прикрепления файлов к заявкам (до 10 МБ, форматы: PDF, JPG, PNG, DOCX).", _
        "Система комментариев для фиксации истории взаимодействия с клиентом.", _
        "Отправка уведомлений в Telegram при изменении статуса заявки или добавлении комментария.", _
        "Разграничение прав доступа к заявкам на основе принадлежности к компании.")

    ' Добавление текста после списка
    textТребования = "Функциональные требования к модулю ИИ-аналитики:" & vbCr

    Selection.TypeText textТребования

    ' Добавление маркированного списка требований к ИИ-аналитике
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Автоматическая категоризация заявок по типу запроса (жалоба, вопрос, предложение и т.д.).", _
        "Суммаризация текста заявки для быстрого ознакомления с её сутью.", _
        "Генерация шаблонов ответов на основе содержания заявки.", _
        "Оценка релевантности заявки по шкале от 1 до 10.", _
        "Асинхронная обработка заявок через систему очередей для обеспечения отзывчивости интерфейса.", _
        "Возможность ручной корректировки результатов автоматической обработки.")

    ' Добавление текста после списка
    textТребования = "Функциональные требования к дашборду аналитики:" & vbCr

    Selection.TypeText textТребования

    ' Добавление маркированного списка требований к дашборду
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отображение ключевых метрик: количество заявок, конверсия, средняя оценка релевантности.", _
        "Визуализация распределения заявок по источникам и категориям.", _
        "Возможность фильтрации данных по временному периоду, статусу, источнику и другим параметрам.", _
        "Экспорт данных в форматы CSV и XLSX.", _
        "Интерактивные графики с возможностью детализации данных.", _
        "Автоматическое обновление данных без перезагрузки страницы.")

    ' Добавление текста после списка
    textТребования = "Функциональные требования к интеграции с внешними системами:" & vbCr

    Selection.TypeText textТребования

    ' Добавление маркированного списка требований к интеграции
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Синхронизация заявок с CRM-системой Bitrix24.", _
        "Отправка уведомлений в мессенджер Telegram.", _
        "Возможность интеграции с email-сервисами для автоматической обработки входящих писем.", _
        "API для интеграции с внешними системами аналитики и отчетности.")

    ' Добавление текста после списка
    textТребования = "Нефункциональные требования к системе:" & vbCr

    Selection.TypeText textТребования

    ' Добавление маркированного списка нефункциональных требований
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Производительность: обработка до 100 заявок в минуту с временем отклика API не более 300 мс.", _
        "Безопасность: шифрование данных при передаче (HTTPS), хранение паролей в зашифрованном виде, защита от SQL-инъекций и XSS-атак.", _
        "Надежность: доступность системы 99,9%, регулярное резервное копирование данных.", _
        "Масштабируемость: возможность горизонтального масштабирования при увеличении нагрузки.", _
        "Юзабилити: интуитивно понятный интерфейс, адаптивный дизайн для мобильных устройств, время загрузки страниц не более 2 секунд.", _
        "Совместимость: работа во всех современных браузерах (Chrome, Firefox, Safari, Edge).")

    ' Добавление текста после списка
    textТребования = "Технические требования к разрабатываемому программному обеспечению:" & vbCr

    Selection.TypeText textТребования

    ' Добавление маркированного списка технических требований
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Серверная часть: PHP 8.1+, Laravel 10, MySQL/PostgreSQL.", _
        "Клиентская часть: HTML5, CSS3, JavaScript, Laravel Blade, Livewire.", _
        "Интеграция с OpenAI API для функций искусственного интеллекта.", _
        "Система очередей для асинхронной обработки заявок.", _
        "Система ролей и разрешений для обеспечения безопасности.", _
        "Документирование API с использованием Swagger/OpenAPI.")

    ' Добавление текста после списка
    textТребования = "Сформулированные требования послужили основой для проектирования и разработки системы " & _
                   "LeadFlow Analytics, обеспечивая соответствие конечного продукта потребностям бизнеса и " & _
                   "решение выявленных проблем в существующих бизнес-процессах обработки клиентских заявок." & vbCr & vbCr & _
                   "Требования были согласованы с руководством компании и легли в основу технического задания " & _
                   "на разработку системы."

    Selection.TypeText textТребования
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Архитектура разработанной системы"
Sub ДобавитьСодержимоеАрхитектураСистемы(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textАрхитектура As String

    textАрхитектура = "В рамках производственной практики была разработана система LeadFlow Analytics, " & _
                    "представляющая собой веб-приложение для сбора, анализа и автоматизации обработки " & _
                    "клиентских заявок. Архитектура системы спроектирована с учетом современных подходов " & _
                    "к разработке программного обеспечения, обеспечивая масштабируемость, надежность и " & _
                    "безопасность работы приложения." & vbCr & vbCr & _
                    "Система LeadFlow Analytics реализована на основе архитектурного шаблона MVC " & _
                    "(Model-View-Controller), что обеспечивает четкое разделение бизнес-логики, представления " & _
                    "данных и управляющей логики. Это позволяет эффективно организовать код, упростить его " & _
                    "поддержку и развитие в будущем." & vbCr & vbCr & _
                    "Обобщенная архитектура системы LeadFlow Analytics представлена на рисунке 2.1." & vbCr

    Selection.TypeText textАрхитектура

    ' Добавление рисунка-заглушки для архитектуры системы
    ДобавитьРисунокЗаглушку docTarget, "Обобщенная архитектура системы LeadFlow Analytics"

    ' Продолжение текста
    textАрхитектура = "Система имеет модульную структуру и состоит из следующих основных компонентов:" & vbCr

    Selection.TypeText textАрхитектура

    ' Добавление маркированного списка компонентов системы
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Серверная часть (Backend) – реализована на PHP-фреймворке Laravel 10, обеспечивает обработку " & _
        "бизнес-логики, взаимодействие с базой данных, аутентификацию и авторизацию, а также предоставляет " & _
        "API для внешних систем.", _
        "Клиентская часть (Frontend) – построена на основе Blade-шаблонов Laravel и компонентов Livewire, " & _
        "обеспечивает пользовательский интерфейс с интерактивными элементами без необходимости писать " & _
        "большой объем JavaScript-кода.", _
        "База данных – MySQL, хранит структурированные данные о компаниях, пользователях, заявках и связанной " & _
        "с ними информации.", _
        "Модуль интеграции с OpenAI API – обеспечивает функционал ИИ-аналитики через взаимодействие с " & _
        "внешним API искусственного интеллекта.", _
        "Модуль интеграции с Bitrix24 – обеспечивает синхронизацию данных с внешней CRM-системой.", _
        "Модуль интеграции с Telegram – реализует функционал уведомлений через Telegram Bot API.")

    ' Добавление текста после списка
    textАрхитектура = "Система спроектирована с учетом требования мультитенантности, что позволяет на " & _
                    "одной инсталляции обслуживать множество клиентов (компаний) с изоляцией их данных " & _
                    "друг от друга. Для этого все основные сущности в системе (заявки, пользователи, файлы и др.) " & _
                    "привязаны к конкретной компании через поле company_id." & vbCr & vbCr & _
                    "Взаимодействие между компонентами системы организовано на основе асинхронных механизмов " & _
                    "через очереди заданий (Laravel Queues) для обеспечения высокой производительности и " & _
                    "отзывчивости интерфейса. Особенно это важно для операций, связанных с обработкой данных " & _
                    "с использованием ИИ и интеграцией с внешними системами." & vbCr & vbCr & _
                    "Далее будет подробно рассмотрена реализация каждого компонента системы."

    Selection.TypeText textАрхитектура
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Серверная часть (Laravel Framework)"
Sub ДобавитьСодержимоеСервернаяЧасть(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textСервер As String

    textСервер = "Серверная часть системы LeadFlow Analytics реализована на базе PHP-фреймворка Laravel 10, " & _
               "который обеспечивает надежную основу для разработки высоконагруженных веб-приложений. " & _
               "Laravel был выбран в качестве основного фреймворка благодаря следующим преимуществам:" & vbCr

    Selection.TypeText textСервер

    ' Добавление маркированного списка преимуществ Laravel
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Элегантный синтаксис и обширный функционал, ускоряющий разработку.", _
        "Мощная ORM (Eloquent) для работы с базами данных.", _
        "Встроенная система миграций для управления схемой базы данных.", _
        "Развитая система маршрутизации (Routing) для API и веб-интерфейса.", _
        "Механизм middleware для обработки HTTP-запросов.", _
        "Встроенная поддержка очередей (Queues) для асинхронных операций.", _
        "Система обработки событий (Events & Listeners).", _
        "Инструменты для аутентификации и авторизации пользователей.", _
        "Богатая экосистема пакетов и расширений.")

    ' Добавление текста после списка
    textСервер = "Архитектура серверной части следует принятым в Laravel практикам и включает " & _
               "следующие основные компоненты:" & vbCr & vbCr & _
               "1. Модели (Models) – представляют сущности базы данных и бизнес-логику работы с ними. " & _
               "Основные модели системы:" & vbCr

    Selection.TypeText textСервер

    ' Добавление подсписка моделей
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Company – компания-клиент, основная сущность для реализации мультитенантности.", _
        "User – пользователь системы, связанный с конкретной компанией.", _
        "Lead – заявка от клиента с относящимися к ней данными.", _
        "LeadComment – комментарии к заявкам.", _
        "LeadFile – файлы, прикрепленные к заявкам.", _
        "LeadEvent – события, связанные с жизненным циклом заявки.", _
        "LeadMetric – метрики для аналитики по заявкам.", _
        "Tag – теги для категоризации заявок.", _
        "LeadAnalytics – результаты ИИ-анализа заявок.")

    ' Продолжение текста
    textСервер = "2. Контроллеры (Controllers) – обрабатывают HTTP-запросы, взаимодействуют с моделями " & _
               "и возвращают ответ клиенту. Основные группы контроллеров:" & vbCr

    Selection.TypeText textСервер

    ' Добавление подсписка контроллеров
    ДобавитьМаркированныйСписок docTarget, Array( _
        "ApiController – обработка запросов к API, включая прием заявок и взаимодействие с внешними системами.", _
        "CrmController – управление заявками через веб-интерфейс системы.", _
        "AnalyticsController – формирование аналитических данных и отчетов.", _
        "SettingsController – управление настройками системы и пользователей.", _
        "AuthController – обработка процессов аутентификации и авторизации.")

    ' Продолжение текста
    textСервер = "3. Сервисы (Services) – содержат бизнес-логику, абстрагированную от контроллеров, " & _
               "для повышения модульности и тестируемости кода. Основные сервисы:" & vbCr

    Selection.TypeText textСервер

    ' Добавление подсписка сервисов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "LeadService – бизнес-логика работы с заявками.", _
        "AnalyticsService – генерация и обработка аналитических данных.", _
        "AIService – взаимодействие с OpenAI API для анализа заявок.", _
        "BitrixIntegrationService – синхронизация данных с Bitrix24.", _
        "TelegramService – отправка уведомлений в Telegram.", _
        "FileService – обработка загрузки и хранения файлов.")

    ' Продолжение текста
    textСервер = "4. Middleware – компоненты, обрабатывающие HTTP-запросы до или после основной обработки " & _
               "контроллером. В системе реализованы следующие ключевые middleware:" & vbCr

    Selection.TypeText textСервер

    ' Добавление подсписка middleware
    ДобавитьМаркированныйСписок docTarget, Array( _
        "ApiKeyMiddleware – проверка API-ключа при обращении к API.", _
        "CompanyAccessMiddleware – ограничение доступа к данным только своей компании.", _
        "RoleMiddleware – проверка ролей и прав пользователя.")

    ' Продолжение текста
    textСервер = "5. Jobs (Задания) – классы для выполнения асинхронных операций через систему очередей " & _
               "Laravel. Основные задания:" & vbCr

    Selection.TypeText textСервер

    ' Добавление подсписка заданий
    ДобавитьМаркированныйСписок docTarget, Array( _
        "ProcessLeadWithAI – анализ заявки с использованием ИИ.", _
        "SyncLeadToBitrix – отправка данных заявки в Bitrix24.", _
        "SendTelegramNotification – отправка уведомления в Telegram.", _
        "GenerateAnalyticsReport – формирование аналитического отчета.")

    ' Продолжение текста
    textСервер = "6. События (Events) и слушатели (Listeners) – механизм для реализации слабосвязанной " & _
               "архитектуры, где одно событие может вызывать несколько действий. Примеры событий:" & vbCr

    Selection.TypeText textСервер

    ' Добавление подсписка событий
    ДобавитьМаркированныйСписок docTarget, Array( _
        "LeadCreated – создание новой заявки.", _
        "LeadStatusChanged – изменение статуса заявки.", _
        "CommentAdded – добавление комментария к заявке.")

    ' Заключительный текст
    textСервер = "Для обеспечения безопасности и разграничения прав доступа в системе использован пакет " & _
               "Spatie Laravel Permission, позволяющий гибко настраивать роли и разрешения для пользователей. " & _
               "Основные роли в системе: Admin (Администратор), Manager (Менеджер), Viewer (Наблюдатель)." & vbCr & vbCr & _
               "Для работы с асинхронными задачами настроена система очередей Laravel Queues с " & _
               "использованием драйвера Redis, что обеспечивает эффективную обработку заданий, требующих " & _
               "длительного выполнения, таких как анализ заявок с использованием ИИ или интеграция с " & _
               "внешними системами." & vbCr & vbCr & _
               "Для обеспечения надежности и облегчения отладки в системе настроено логирование с " & _
               "использованием Monolog, что позволяет сохранять информацию о работе системы, ошибках и " & _
               "важных событиях."

    Selection.TypeText textСервер
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Клиентская часть (Livewire, Blade)"
Sub ДобавитьСодержимоеКлиентскаяЧасть(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textКлиент As String

    textКлиент = "Клиентская часть системы LeadFlow Analytics разработана с использованием современных " & _
               "технологий, обеспечивающих интерактивный пользовательский интерфейс и удобство работы с " & _
               "системой. Основу клиентской части составляют следующие технологии:" & vbCr

    Selection.TypeText textКлиент

    ' Добавление маркированного списка технологий клиентской части
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Blade – шаблонизатор Laravel для формирования HTML-разметки.", _
        "Livewire – библиотека для создания интерактивных компонентов без необходимости писать JavaScript.", _
        "TailwindCSS – утилитарный CSS-фреймворк для стилизации интерфейса.", _
        "Alpine.js – минималистичный JavaScript-фреймворк для добавления интерактивности.", _
        "Chart.js – библиотека для создания графиков и диаграмм.", _
        "HTMX – библиотека для AJAX-запросов и динамического обновления контента.", _
        "FilePond – библиотека для загрузки файлов с предпросмотром.")

    ' Добавление текста после списка
    textКлиент = "Архитектура клиентской части построена на компонентном подходе, где каждый элемент " & _
               "интерфейса представлен отдельным многоразовым компонентом. Это обеспечивает модульность, " & _
               "повторное использование кода и удобство сопровождения." & vbCr & vbCr & _
               "Основные компоненты клиентской части:" & vbCr

    Selection.TypeText textКлиент

    ' Добавление маркированного списка компонентов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "LeadTable – интерактивная таблица для отображения списка заявок с возможностью фильтрации, " & _
        "сортировки и постраничной навигации.", _
        "LeadView – компонент для просмотра детальной информации о заявке.", _
        "LeadEditor – форма для редактирования данных заявки.", _
        "FileUploader – компонент для загрузки файлов с предпросмотром и валидацией.", _
        "CommentSection – система комментариев к заявкам.", _
        "MetricsChart – компонент для визуализации аналитических данных.", _
        "DateRangePicker – выбор диапазона дат для фильтрации.", _
        "TagSelector – выбор и управление тегами.")

    ' Продолжение текста
    textКлиент = "Пример интерфейса системы LeadFlow Analytics (раздел управления заявками) " & _
               "представлен на рисунке 2.2." & vbCr

    Selection.TypeText textКлиент

    ' Добавление рисунка-заглушки для интерфейса
    ДобавитьРисунокЗаглушку docTarget, "Интерфейс системы LeadFlow Analytics"

    ' Продолжение текста
    textКлиент = "Благодаря использованию Livewire, большая часть интерактивности реализована без " & _
               "необходимости писать сложный JavaScript-код. Livewire обеспечивает двустороннюю связь " & _
               "между сервером и клиентом, позволяя обновлять данные на странице без полной перезагрузки. " & _
               "Это особенно важно для таких компонентов, как фильтры, таблицы с пагинацией и формы " & _
               "редактирования." & vbCr & vbCr & _
               "Для обеспечения адаптивности интерфейса под различные устройства (десктоп, планшет, " & _
               "мобильный телефон) использован подход Mobile First с применением медиа-запросов CSS и " & _
               "утилит TailwindCSS. Это позволяет системе корректно отображаться на экранах любого размера, " & _
               "обеспечивая удобство работы пользователей с различных устройств." & vbCr & vbCr & _
               "Для визуализации аналитических данных использована библиотека Chart.js, позволяющая " & _
               "создавать интерактивные графики и диаграммы различных типов: линейные, столбчатые, " & _
               "круговые. Данные для графиков подгружаются асинхронно через AJAX-запросы, что обеспечивает " & _
               "быструю загрузку страницы и актуальность отображаемой информации." & vbCr & vbCr & _
               "Для работы с файлами реализован компонент на базе библиотеки FilePond, обеспечивающий " & _
               "возможность загрузки файлов с предпросмотром изображений, валидацией типов и размеров " & _
               "файлов, а также асинхронной загрузкой без перезагрузки страницы." & vbCr & vbCr & _
               "В целях обеспечения безопасности клиентской части реализованы следующие механизмы:" & vbCr

    Selection.TypeText textКлиент

    ' Добавление маркированного списка механизмов безопасности
    ДобавитьМаркированныйСписок docTarget, Array( _
        "CSRF-защита для всех форм и AJAX-запросов.", _
        "Проверка прав доступа на уровне UI (скрытие элементов управления).", _
        "Санитизация выводимых данных для предотвращения XSS-атак.", _
        "Валидация данных на стороне клиента перед отправкой на сервер.")

    ' Заключительный текст
    textКлиент = "Таким образом, клиентская часть системы LeadFlow Analytics представляет собой современное " & _
               "интерактивное веб-приложение, обеспечивающее удобный интерфейс для работы с системой " & _
               "при соблюдении требований безопасности и производительности."

    Selection.TypeText textКлиент
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "База данных и схема данных"
Sub ДобавитьСодержимоеБазаДанных(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textБД As String

    textБД = "База данных системы LeadFlow Analytics спроектирована с учетом требований к хранению и " & _
            "обработке данных о заявках, пользователях, компаниях и аналитической информации. В качестве " & _
            "СУБД использована MySQL, обеспечивающая надежное хранение данных и эффективное выполнение " & _
            "запросов." & vbCr & vbCr & _
            "Схема базы данных разработана в соответствии с принципами нормализации для минимизации " & _
            "избыточности данных и обеспечения целостности. Для управления схемой использован механизм " & _
            "миграций Laravel, что позволяет контролировать версионность схемы и упрощает развертывание " & _
            "системы." & vbCr & vbCr & _
            "На рисунке 2.3 представлена ER-диаграмма базы данных системы LeadFlow Analytics." & vbCr

    Selection.TypeText textБД

    ' Добавление рисунка-заглушки для ER-диаграммы
    ДобавитьРисунокЗаглушку docTarget, "ER-диаграмма базы данных системы LeadFlow Analytics"

    ' Продолжение текста
    textБД = "Основные сущности базы данных и их назначение:" & vbCr

    Selection.TypeText textБД

    ' Добавление таблицы с описанием сущностей БД
    ДобавитьТаблицуСущностиБД docTarget

    ' Продолжение текста
    textБД = "Для обеспечения эффективной работы с данными в базе данных созданы индексы для " & _
            "полей, по которым часто выполняются поиск, сортировка и фильтрация:" & vbCr

    Selection.TypeText textБД

    ' Добавление маркированного списка индексов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Первичные ключи для всех таблиц (id).", _
        "Внешние ключи для связей между таблицами (company_id, lead_id, user_id и др.).", _
        "Индексы для полей фильтрации (status, created_at, relevance_score и др.).", _
        "Составные индексы для оптимизации сложных запросов (company_id, created_at).", _
        "Полнотекстовые индексы для поиска по текстовым полям (message, summary).")

    ' Продолжение текста
    textБД = "Для реализации мультитенантности все основные таблицы содержат поле company_id, " & _
            "связывающее записи с конкретной компанией. На уровне приложения реализованы глобальные " & _
            "скоупы (Global Scopes) для моделей Eloquent, автоматически добавляющие условие фильтрации " & _
            "по компании в каждый запрос. Это обеспечивает изоляцию данных между клиентами системы " & _
            "и предотвращает возможность несанкционированного доступа к чужим данным." & vbCr & vbCr & _
            "Для обеспечения целостности данных в базе определены ограничения:" & vbCr

    Selection.TypeText textБД

    ' Добавление маркированного списка ограничений
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Внешние ключи с каскадным удалением связанных записей (ON DELETE CASCADE).", _
        "Ограничения уникальности для предотвращения дублирования данных.", _
        "Ограничения NOT NULL для обязательных полей.", _
        "Ограничения CHECK для полей с предопределенным диапазоном значений.")

    ' Продолжение текста
    textБД = "Для упрощения работы с данными в приложении используется ORM Eloquent, предоставляющая " & _
            "объектно-ориентированный интерфейс для взаимодействия с базой данных. Для каждой таблицы " & _
            "создана соответствующая модель с определением отношений между сущностями (один-ко-многим, " & _
            "многие-ко-многим и т.д.), методами доступа к данным и бизнес-логикой." & vbCr & vbCr & _
            "С целью оптимизации производительности реализованы следующие механизмы:" & vbCr

    Selection.TypeText textБД

    ' Добавление маркированного списка механизмов оптимизации
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Eager Loading для предотвращения проблемы N+1 запросов при загрузке связанных данных.", _
        "Кэширование результатов запросов с использованием Redis.", _
        "Пагинация для ограничения объема выбираемых данных.", _
        "Оптимизация запросов с помощью конструктора запросов Laravel.")

    ' Заключительный текст
    textБД = "Для миграции данных в системе реализованы сидеры (Seeders) для заполнения таблиц " & _
            "тестовыми данными и фабрики (Factories) для генерации реалистичных данных при разработке " & _
            "и тестировании." & vbCr & vbCr & _
            "Таким образом, спроектированная схема базы данных полностью удовлетворяет требованиям " & _
            "к системе LeadFlow Analytics, обеспечивая эффективное хранение и обработку данных при " & _
            "соблюдении принципов мультитенантности и безопасности."

    Selection.TypeText textБД
    Selection.TypeParagraph
End Sub

' Функция для добавления таблицы с описанием сущностей БД
Sub ДобавитьТаблицуСущностиБД(docTarget As Document)
    Dim tbl As Table

    docTarget.Bookmarks("\EndOfDoc").Range.Select

    ' Создание таблицы
    Set tbl = docTarget.Tables.Add(Range:=Selection.Range, NumRows:=11, NumColumns:=2)

    ' Форматирование таблицы
    With tbl
        .Borders.Enable = True
        .Rows(1).HeadingFormat = True

        .Cell(1, 1).Range.Text = "Таблица"
        .Cell(1, 2).Range.Text = "Описание"

        .Cell(2, 1).Range.Text = "companies"
        .Cell(2, 2).Range.Text = "Компании-клиенты системы. Содержит информацию о клиентах, их настройках, API-ключах."

        .Cell(3, 1).Range.Text = "users"
        .Cell(3, 2).Range.Text = "Пользователи системы, привязанные к компаниям. Содержит данные для аутентификации и профиля."

        .Cell(4, 1).Range.Text = "leads"
        .Cell(4, 2).Range.Text = "Заявки клиентов. Основная таблица, содержащая данные о заявках, их статусе, контактную информацию."

        .Cell(5, 1).Range.Text = "lead_comments"
        .Cell(5, 2).Range.Text = "Комментарии к заявкам, оставленные менеджерами или сгенерированные автоматически."

        .Cell(6, 1).Range.Text = "lead_files"
        .Cell(6, 2).Range.Text = "Файлы, прикрепленные к заявкам. Содержит метаданные о файлах и пути к ним."

        .Cell(7, 1).Range.Text = "tags"
        .Cell(7, 2).Range.Text = "Теги для категоризации заявок."

        .Cell(8, 1).Range.Text = "lead_tag"
        .Cell(8, 2).Range.Text = "Связующая таблица для отношения многие-ко-многим между заявками и тегами."

        .Cell(9, 1).Range.Text = "lead_analytics"
        .Cell(9, 2).Range.Text = "Результаты ИИ-анализа заявок, включая категоризацию, суммаризацию и релевантность."

        .Cell(10, 1).Range.Text = "lead_events"
        .Cell(10, 2).Range.Text = "События, связанные с жизненным циклом заявки (создание, изменение статуса и др.)."

        .Cell(11, 1).Range.Text = "lead_metrics"
        .Cell(11, 2).Range.Text = "Агрегированные метрики для аналитических отчетов."

        .AutoFormat Format:=wdTableFormatSimple1
    End With

    ' Добавление подписи к таблице
    Selection.EndOf Unit:=wdStory
    Selection.TypeParagraph
    Selection.TypeText "Таблица 2.1 – Основные сущности базы данных системы LeadFlow Analytics"
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.TypeParagraph
    Selection.ParagraphFormat.Alignment = wdAlignParagraphJustify
End Sub

' Функция для добавления содержимого раздела "Реализация интеграционного модуля"
Sub ДобавитьСодержимоеИнтеграционныйМодуль(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textИнтеграция1 As String
    Dim textИнтеграция2 As String
    Dim textИнтеграция3 As String

    textИнтеграция1 = "В рамках разработки системы LeadFlow Analytics одной из ключевых задач было создание " & _
                   "интеграционного модуля, обеспечивающего сбор заявок с веб-сайтов клиентов и других " & _
                   "внешних источников."

    textИнтеграция2 = "Реализация этого модуля имеет стратегическое значение, поскольку " & _
                   "именно через него система получает первичные данные для последующей обработки и анализа." & vbCr & vbCr & _
                   "Интеграционный модуль спроектирован с учетом следующих требований:" & vbCr

    Selection.TypeText textИнтеграция1
    Selection.TypeText textИнтеграция2

    ' Добавление маркированного списка требований
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Простота интеграции для клиентов с минимальными техническими знаниями.", _
        "Надежность и отказоустойчивость при обработке входящих запросов.", _
        "Безопасность передачи и хранения данных.", _
        "Валидация входящих данных для обеспечения их целостности.", _
        "Масштабируемость для обработки растущего объема заявок.", _
        "Поддержка мультитенантности для разделения данных между клиентами.")

    ' Продолжение текста
    textИнтеграция1 = "Ключевой компонент интеграционного модуля – RESTful API, предоставляющий " & _
                   "стандартизированный интерфейс для передачи данных о заявках в систему."

    textИнтеграция2 = "REST был " & _
                   "выбран в качестве архитектурного стиля для API благодаря своей простоте, " & _
                   "масштабируемости и широкой поддержке в различных технологиях и платформах." & vbCr & vbCr & _
                   "Интеграционный модуль состоит из следующих основных компонентов:" & vbCr

    Selection.TypeText textИнтеграция1
    Selection.TypeText textИнтеграция2

    ' Добавление маркированного списка компонентов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "API-контроллеры – обрабатывают входящие HTTP-запросы.", _
        "Middleware аутентификации – проверяет API-ключи клиентов.", _
        "Сервисы валидации – проверяют корректность входящих данных.", _
        "Сервисы обработки заявок – сохраняют данные и инициируют их обработку.", _
        "Документация API – описывает структуру запросов и ответов для разработчиков.")

    ' Продолжение текста
    textИнтеграция3 = "Диаграмма последовательности для процесса приема заявки через API представлена " & _
                   "на рисунке 2.4." & vbCr

    Selection.TypeText textИнтеграция3

    ' Добавление рисунка-заглушки для диаграммы последовательности
    ДобавитьРисунокЗаглушку docTarget, "Диаграмма последовательности приема заявки через API"

    ' Заключительный текст
    textИнтеграция1 = "Для обеспечения простоты интеграции клиентских систем с LeadFlow Analytics " & _
                   "разработан набор инструментальных средств:"

    textИнтеграция2 = vbCr & vbCr & _
                   "1. Автоматически генерируемая документация API с использованием Swagger/OpenAPI, " & _
                   "доступная в панели администратора системы." & vbCr & vbCr & _
                   "2. Готовые сниппеты кода для популярных языков программирования (PHP, JavaScript, " & _
                   "Python), которые клиенты могут использовать для быстрой настройки интеграции." & vbCr & vbCr & _
                   "3. Тестовый режим API, позволяющий отправлять тестовые запросы без сохранения " & _
                   "данных в основной базе."

    Selection.TypeText textИнтеграция1
    Selection.TypeText textИнтеграция2
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "API для приема заявок"
Sub ДобавитьСодержимоеAPIЗаявок(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textAPI As String
    Dim codeStoreMethod1 As String
    Dim codeStoreMethod2 As String
    Dim codeStoreMethod3 As String

    textAPI = "Для обеспечения сбора заявок с сайтов клиентов и других внешних источников в системе " & _
            "LeadFlow Analytics реализовано REST API с набором эндпоинтов для приема и обработки данных. " & _
            "Основной эндпоинт для приема заявок – POST /api/leads, который принимает данные в формате JSON " & _
            "и обрабатывает их в соответствии с бизнес-логикой системы." & vbCr & vbCr & _
            "Структура API для приема заявок включает следующие компоненты:" & vbCr

    Selection.TypeText textAPI

    ' Добавление маркированного списка компонентов API
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Route – определение маршрута в routes/api.php, связывающего URI с контроллером.", _
        "ApiKeyMiddleware – промежуточное ПО для авторизации по API-ключу.", _
        "LeadController – контроллер, отвечающий за обработку запросов.", _
        "LeadRequest – класс запроса с правилами валидации данных.", _
        "LeadService – сервис для бизнес-логики обработки заявок.")

    ' Разбиваем код листинга на три части для уменьшения количества продолжений строк
    textAPI = "Фрагмент кода контроллера для обработки входящих заявок приведен в листинге 2.1:" & vbCr & vbCr & _
            "Листинг 2.1 – Метод store контроллера LeadController" & vbCr & vbCr

    Selection.TypeText textAPI

    ' Первая часть кода листинга
    codeStoreMethod1 = "public function store(Request $request)" & vbCr & _
            "{" & vbCr & _
            "    try {" & vbCr & _
            "        // Validate the request" & vbCr & _
            "        $validator = Validator::make($request->all(), [" & vbCr & _
            "            'source' => 'required|string|max:255'," & vbCr & _
            "            'name' => 'nullable|string|max:255'," & vbCr & _
            "            'email' => 'nullable|email|required_without:phone'," & vbCr & _
            "            'phone' => 'nullable|string|max:20|required_without:email'," & vbCr & _
            "            'message' => 'nullable|string'," & vbCr & _
            "            'custom_fields' => 'nullable|array'," & vbCr & _
            "        ]);" & vbCr & vbCr

    Selection.TypeText codeStoreMethod1

    ' Вторая часть кода листинга
    codeStoreMethod2 = "        if ($validator->fails()) {" & vbCr & _
            "            return response()->json([" & vbCr & _
            "                'message' => 'Validation failed'," & vbCr & _
            "                'errors' => $validator->errors()," & vbCr & _
            "                'status' => 'error'" & vbCr & _
            "            ], 400);" & vbCr & vbCr & _
            "        }" & vbCr & vbCr & _
            "        // Get company from request attributes (set by middleware)" & vbCr & vbCr

    Selection.TypeText codeStoreMethod2

    ' Третья часть кода листинга
    codeStoreMethod3 = "        // Create lead" & vbCr & _
            "        $lead = new Lead();" & vbCr & _
            "        $lead->company_id = $company->id;" & vbCr & _
            "        $lead->source = $request->input('source');" & vbCr & _
            "        $lead->name = $request->input('name');" & vbCr & _
            "        $lead->email = $request->input('email');" & vbCr & _
            "        $lead->phone = $request->input('phone');" & vbCr & _
            "        $lead->message = $request->input('message');" & vbCr & _
            "        $lead->custom_fields = $request->input('custom_fields');" & vbCr & _
            "        $lead->save();" & vbCr & vbCr & _
            "        // Queue for AI processing" & vbCr & _
            "        ProcessLeadWithAI::dispatch($lead);" & vbCr & vbCr & _
            "        return response()->json(["

    Selection.TypeText codeStoreMethod3

    ' Четвертая часть кода листинга
    Dim codeStoreMethod4 As String
    codeStoreMethod4 = "            'message' => 'Lead created successfully'," & vbCr & _
            "            'lead_id' => $lead->id," & vbCr & _
            "            'status' => 'success'" & vbCr & _
            "        ], 201);" & vbCr & vbCr & _
            "    } catch (\\Exception $e) {" & vbCr & _
            "        // Log error" & vbCr & _
            "        Log::error('Error creating lead: ' . $e->getMessage());" & vbCr & vbCr & _
            "        return response()->json(["

    Selection.TypeText codeStoreMethod4

    ' Пятая часть кода листинга
    Dim codeStoreMethod5 As String
    codeStoreMethod5 = "            'message' => 'Server error occurred'," & vbCr & _
            "            'status' => 'error'" & vbCr & _
            "        ], 500);" & vbCr & _
            "    }" & vbCr & _
            "}"

    Selection.TypeText codeStoreMethod5

    ' Продолжение текста после листинга
    Dim textAfterListing As String
    textAfterListing = vbCr & vbCr & _
            "Основные этапы обработки заявки в методе store:" & vbCr

    Selection.TypeText textAfterListing

    ' Добавление нумерованного списка этапов
    ДобавитьНумерованныйСписок docTarget, Array( _
        "Валидация входных данных с использованием Laravel Validator.", _
        "Получение компании из атрибутов запроса (установленных middleware).", _
        "Создание и сохранение новой заявки в базе данных.", _
        "Постановка задачи на асинхронную обработку заявки ИИ-модулем.", _
        "Возврат успешного ответа с ID созданной заявки.")

    ' Заключительный текст
    Dim textAPIFinal As String
    textAPIFinal = "Реализация API для приема заявок обеспечивает надежный и безопасный механизм " & _
            "интеграции системы LeadFlow Analytics с внешними источниками данных. Валидация " & _
            "входных данных на стороне сервера и асинхронная обработка заявок позволяют " & _
            "обеспечить высокую производительность и стабильность работы системы даже при " & _
            "высоких нагрузках."

    Selection.TypeText textAPIFinal
    Selection.TypeParagraph

    ' Можно продолжить и добавить другие аспекты API, например документацию Swagger

End Sub

' Функция для добавления содержимого раздела "Механизм авторизации и аутентификации"
Sub ДобавитьСодержимоеМеханизмАвторизации(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textАвторизация As String

    textАвторизация = "Для обеспечения безопасного доступа к API системы LeadFlow Analytics реализован " & _
                     "надежный механизм авторизации и аутентификации, основанный на использовании API-ключей. " & _
                     "Данный подход был выбран из-за его простоты, надежности и соответствия требованиям " & _
                     "безопасности для интеграционных сценариев." & vbCr & vbCr & _
                     "Основные компоненты механизма авторизации:" & vbCr

    Selection.TypeText textАвторизация

    ' Добавление маркированного списка компонентов механизма авторизации
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Генерация и хранение API-ключей – уникальные ключи генерируются для каждой компании-клиента и хранятся в базе данных в зашифрованном виде.", _
        "ApiKeyMiddleware – промежуточное ПО, проверяющее наличие и валидность API-ключа в заголовке запроса.", _
        "Систeма разграничения доступа – обеспечивает доступ только к данным соответствующей компании.", _
        "Механизм обновления ключей – возможность регенерации API-ключа в случае компрометации.")

    ' Добавление текста после списка
    textАвторизация = "Процесс авторизации запроса происходит следующим образом:" & vbCr

    Selection.TypeText textАвторизация

    ' Добавление нумерованного списка этапов авторизации
    ДобавитьНумерованныйСписок docTarget, Array( _
        "Клиент отправляет запрос к API, указывая свой API-ключ в заголовке X-API-Key.", _
        "ApiKeyMiddleware перехватывает запрос и извлекает API-ключ из заголовка.", _
        "Происходит поиск компании с соответствующим API-ключом в базе данных.", _
        "При успешной идентификации компании, её идентификатор добавляется в атрибуты запроса для дальнейшего использования.", _
        "Если API-ключ не найден или недействителен, возвращается ответ с кодом 403 Forbidden.")

    ' Продолжение текста
    textАвторизация = "Для управления API-ключами реализован административный интерфейс в панели управления " & _
                     "системы, где администратор компании может:" & vbCr

    Selection.TypeText textАвторизация

    ' Добавление маркированного списка возможностей управления ключами
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Просматривать текущий API-ключ в замаскированном виде.", _
        "Регенерировать ключ в случае необходимости с подтверждением действия.", _
        "Получать инструкции по интеграции с примерами кода.")

    ' Добавление текста после списка
    textАвторизация = "Пример кода реализации ApiKeyMiddleware, осуществляющего проверку API-ключа:" & vbCr & vbCr

    Selection.TypeText textАвторизация

    ' Добавление примера кода (листинг)
    Dim codeMiddleware As String
    codeMiddleware = "public function handle(Request $request, Closure $next)" & vbCr & _
                    "{" & vbCr & _
                    "    // Получение API-ключа из заголовка" & vbCr & _
                    "    $apiKey = $request->header('X-API-Key');" & vbCr & vbCr & _
                    "    // Проверка наличия ключа" & vbCr & _
                    "    if (!$apiKey) {" & vbCr & _
                    "        return response()->json([" & vbCr & _
                    "            'message' => 'API key is missing'," & vbCr & _
                    "            'status' => 'error'" & vbCr & _
                    "        ], 403);" & vbCr & _
                    "    }" & vbCr & vbCr & _
                    "    // Поиск компании по API-ключу" & vbCr & _
                    "    $company = Company::where('api_key', $apiKey)->first();" & vbCr & vbCr & _
                    "    // Проверка валидности ключа" & vbCr & _
                    "    if (!$company) {" & vbCr & _
                    "        return response()->json([" & vbCr & _
                    "            'message' => 'Invalid API key'," & vbCr & _
                    "            'status' => 'error'" & vbCr & _
                    "        ], 403);" & vbCr & _
                    "    }" & vbCr & vbCr & _
                    "    // Добавление компании в атрибуты запроса" & vbCr & _
                    "    $request->attributes->set('company', $company);" & vbCr & vbCr & _
                    "    // Передача запроса дальше" & vbCr & _
                    "    return $next($request);" & vbCr & _
                    "}"

    Selection.TypeText codeMiddleware
    Selection.TypeParagraph

    ' Заключительный текст
    textАвторизация = "Для обеспечения безопасности API-ключей приняты следующие меры:" & vbCr

    Selection.TypeText textАвторизация

    ' Добавление маркированного списка мер безопасности
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Использование HTTPS для шифрования передаваемых данных.", _
        "Хранение ключей в базе данных в защищенном виде.", _
        "Регулярное логирование всех запросов к API для аудита.", _
        "Возможность немедленной деактивации скомпрометированного ключа.", _
        "Генерация ключей с использованием криптографически стойких алгоритмов.")

    ' Заключительный абзац
    textАвторизация = "Внедренный механизм авторизации и аутентификации обеспечивает необходимый уровень " & _
                     "защиты API системы LeadFlow Analytics, позволяя безопасно интегрировать её с " & _
                     "внешними системами при сохранении изоляции данных между клиентами в рамках " & _
                     "мультитенантной архитектуры."

    Selection.TypeText textАвторизация
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Разработка мини-CRM модуля"
Sub ДобавитьСодержимоеМиниCRM(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textМиниCRM As String

    textМиниCRM = "В рамках разработки системы LeadFlow Analytics был реализован модуль мини-CRM, предназначенный " & _
                 "для эффективного управления клиентскими заявками на всех этапах их жизненного цикла. " & _
                 "Данный модуль является центральным компонентом системы, обеспечивающим взаимодействие " & _
                 "пользователей с заявками, полученными через интеграционные каналы." & vbCr & vbCr & _
                 "При разработке мини-CRM модуля решались следующие задачи:" & vbCr

    Selection.TypeText textМиниCRM

    ' Добавление маркированного списка задач
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Создание интуитивно понятного интерфейса для работы с заявками.", _
        "Реализация гибкой системы статусов и тегов для категоризации заявок.", _
        "Обеспечение возможности загрузки и хранения файлов, связанных с заявками.", _
        "Интеграция с системой уведомлений в Telegram.", _
        "Реализация механизма комментирования для фиксации истории взаимодействия с клиентом.", _
        "Обеспечение мультитенантности для изоляции данных между компаниями.")

    ' Продолжение текста
    textМиниCRM = "Модуль мини-CRM базируется на современных технологиях и лучших практиках разработки " & _
                 "веб-приложений, обеспечивая производительность, безопасность и удобство использования. " & _
                 "В качестве базовой архитектуры использована модель MVC (Model-View-Controller), " & _
                 "дополненная интерактивными компонентами Livewire для создания динамического пользовательского " & _
                 "интерфейса без необходимости написания большого объема JavaScript-кода." & vbCr & vbCr & _
                 "Ключевые особенности реализованного мини-CRM модуля:" & vbCr

    Selection.TypeText textМиниCRM

    ' Добавление маркированного списка особенностей
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Гибкость системы статусов – заявки могут находиться в одном из предопределенных статусов: 'Новая', 'В работе', 'Завершена', 'Архив'.", _
        "Тегирование заявок – возможность присвоения тегов для дополнительной категоризации (например, 'Срочно', 'VIP', 'Требует уточнения').", _
        "Система комментариев – возможность добавления комментариев к заявкам для фиксации истории взаимодействия.", _
        "Уведомления в Telegram – автоматическая отправка уведомлений о важных событиях (новая заявка, изменение статуса).", _
        "Загрузка файлов – возможность прикрепления файлов к заявкам с предпросмотром для изображений.", _
        "Разграничение прав доступа – разные уровни доступа для администраторов, менеджеров и пользователей-наблюдателей.")

    ' Добавление рисунка-заглушки для интерфейса мини-CRM
    textМиниCRM = "На рисунке 2.5 представлен внешний вид главного экрана мини-CRM модуля с таблицей заявок." & vbCr

    Selection.TypeText textМиниCRM
    ДобавитьРисунокЗаглушку docTarget, "Интерфейс главного экрана мини-CRM модуля системы LeadFlow Analytics"

    ' Заключительный текст
    textМиниCRM = "Модуль мини-CRM в системе LeadFlow Analytics представляет собой гибкий инструмент для " & _
                 "управления клиентскими заявками, объединяющий функциональность базовой CRM-системы с " & _
                 "интеграцией современных интерактивных технологий и искусственного интеллекта. Данный модуль " & _
                 "спроектирован с учетом масштабируемости и возможности расширения функциональности в " & _
                 "будущих версиях системы."

    Selection.TypeText textМиниCRM
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Структура и компоненты мини-CRM"
Sub ДобавитьСодержимоеСтруктураCRM(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textСтруктураCRM As String

    textСтруктураCRM = "Структура мини-CRM модуля системы LeadFlow Analytics спроектирована с учетом " & _
                      "современных подходов к разработке веб-приложений и лучших практик построения " & _
                      "CRM-систем. Архитектура модуля обеспечивает гибкость, масштабируемость и надежность " & _
                      "при работе с клиентскими заявками." & vbCr & vbCr & _
                      "Модуль мини-CRM состоит из следующих основных компонентов:" & vbCr

    Selection.TypeText textСтруктураCRM

    ' Добавление маркированного списка компонентов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Модели данных – представляют сущности базы данных и бизнес-логику работы с ними.", _
        "Контроллеры – обрабатывают HTTP-запросы и управляют логикой приложения.", _
        "Livewire-компоненты – обеспечивают интерактивность пользовательского интерфейса.", _
        "Blade-шаблоны – формируют HTML-разметку для отображения интерфейса.", _
        "Сервисы – инкапсулируют бизнес-логику работы с заявками и связанными сущностями.", _
        "Системы событий и слушателей – обеспечивают реакцию на различные события в системе.")

    ' Продолжение текста - описание моделей данных
    textСтруктураCRM = "Основные модели данных (Models), используемые в мини-CRM модуле:" & vbCr

    Selection.TypeText textСтруктураCRM

    ' Добавление таблицы с моделями данных
    Dim tbl As Table
    Set tbl = docTarget.Tables.Add(Range:=Selection.Range, NumRows:=6, NumColumns:=2)

    ' Заполнение таблицы
    With tbl
        .Borders.Enable = True
        .Rows(1).HeadingFormat = True

        .Cell(1, 1).Range.Text = "Модель"
        .Cell(1, 2).Range.Text = "Описание"

        .Cell(2, 1).Range.Text = "Lead"
        .Cell(2, 2).Range.Text = "Основная модель, представляющая клиентскую заявку со всеми её атрибутами (статус, источник, контактные данные и т.д.)."

        .Cell(3, 1).Range.Text = "LeadComment"
        .Cell(3, 2).Range.Text = "Комментарии к заявкам, оставленные менеджерами или созданные автоматически."

        .Cell(4, 1).Range.Text = "LeadFile"
        .Cell(4, 2).Range.Text = "Файлы, прикрепленные к заявкам (документы, изображения и т.д.)."

        .Cell(5, 1).Range.Text = "Tag"
        .Cell(5, 2).Range.Text = "Теги для категоризации заявок с возможностью привязки к конкретной компании."

        .Cell(6, 1).Range.Text = "LeadAnalytics"
        .Cell(6, 2).Range.Text = "Результаты анализа заявки с использованием ИИ (категория, сводка, оценка релевантности)."

        .AutoFormat Format:=wdTableFormatSimple1
    End With

    ' Добавление подписи к таблице
    Selection.EndOf Unit:=wdStory
    Selection.TypeParagraph
    Selection.TypeText "Таблица 2.2 – Основные модели данных мини-CRM модуля"
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.TypeParagraph
    Selection.ParagraphFormat.Alignment = wdAlignParagraphJustify

    ' Продолжение текста - описание контроллеров
    textСтруктураCRM = "Ключевые контроллеры (Controllers) мини-CRM модуля:" & vbCr

    Selection.TypeText textСтруктураCRM

    ' Добавление маркированного списка контроллеров
    ДобавитьМаркированныйСписок docTarget, Array( _
        "CrmController – обеспечивает отображение главной страницы CRM с таблицей заявок и фильтрами.", _
        "LeadController – отвечает за управление заявками (просмотр, редактирование, изменение статуса).", _
        "CommentController – управляет созданием, редактированием и удалением комментариев.", _
        "FileController – обеспечивает загрузку, скачивание и удаление файлов.", _
        "TagController – управляет тегами и их привязкой к заявкам.")

    ' Продолжение текста - описание Livewire-компонентов
    textСтруктураCRM = "Интерактивные Livewire-компоненты, используемые в мини-CRM модуле:" & vbCr

    Selection.TypeText textСтруктураCRM

    ' Добавление маркированного списка Livewire-компонентов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "LeadTable – интерактивная таблица заявок с сортировкой, фильтрацией и пагинацией.", _
        "LeadForm – форма для создания и редактирования заявки.", _
        "CommentSection – компонент для отображения и добавления комментариев.", _
        "FileUploader – компонент для загрузки файлов с предпросмотром изображений.", _
        "TagSelector – компонент для выбора и управления тегами заявки.", _
        "StatusSelector – компонент для изменения статуса заявки с подтверждением.")

    ' Диаграмма компонентов
    textСтруктураCRM = "Взаимодействие компонентов мини-CRM модуля представлено на диаграмме (Рисунок 2.6)." & vbCr

    Selection.TypeText textСтруктураCRM
    ДобавитьРисунокЗаглушку docTarget, "Диаграмма компонентов мини-CRM модуля системы LeadFlow Analytics"

    ' Заключительный текст
    textСтруктураCRM = "Разработанная структура мини-CRM модуля обеспечивает четкое разделение ответственности " & _
                      "между компонентами, что способствует улучшению сопровождаемости кода и упрощает добавление " & _
                      "новой функциональности. Использование моделей данных Eloquent ORM позволяет " & _
                      "абстрагироваться от деталей работы с базой данных и сосредоточиться на бизнес-логике " & _
                      "приложения." & vbCr & vbCr & _
                      "Важным аспектом структуры мини-CRM модуля является реализация мультитенантности через " & _
                      "привязку всех основных сущностей к конкретной компании (company_id), что обеспечивает " & _
                      "изоляцию данных между клиентами системы и повышает безопасность работы с информацией."

    Selection.TypeText textСтруктураCRM
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Функциональные возможности мини-CRM"
Sub ДобавитьСодержимоеФункцииCRM(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textФункцииCRM1 As String
    Dim textФункцииCRM2 As String
    Dim textФункцииCRM3 As String

    ' Вводная часть
    textФункцииCRM1 = "Мини-CRM модуль системы LeadFlow Analytics предоставляет широкий спектр функциональных "
    textФункцииCRM2 = "возможностей для эффективного управления клиентскими заявками. Реализованный функционал "
    textФункцииCRM3 = "охватывает все ключевые аспекты работы с заявками от момента их поступления до завершения " & _
                    "обработки." & vbCr & vbCr & _
                    "Основные функциональные возможности мини-CRM модуля:" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.TypeText textФункцииCRM2
    Selection.TypeText textФункцииCRM3

    ' Добавление подзаголовка: Управление заявками
    textФункцииCRM1 = "1. Управление заявками" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание управления заявками
    textФункцииCRM1 = "Управление заявками включает следующие возможности:" & vbCr

    Selection.TypeText textФункцииCRM1

    ' Добавление маркированного списка возможностей управления заявками
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Просмотр списка заявок с возможностью фильтрации по статусу, источнику, дате создания и другим параметрам.", _
        "Сортировка заявок по различным полям (дата создания, статус, релевантность).", _
        "Поиск заявок по ключевым словам и контактной информации.", _
        "Просмотр детальной информации о заявке, включая историю изменений и комментарии.", _
        "Редактирование данных заявки с валидацией вводимой информации.", _
        "Изменение статуса заявки с фиксацией времени изменения и ответственного сотрудника.", _
        "Автоматическое отслеживание времени пребывания заявки в каждом статусе.")

    ' Добавление подзаголовка: Система статусов и тегов
    textФункцииCRM1 = "2. Система статусов и тегов" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание системы статусов и тегов
    textФункцииCRM1 = "В рамках мини-CRM модуля реализована гибкая система статусов и тегов:" & vbCr

    Selection.TypeText textФункцииCRM1

    ' Добавление описания статусов
    textФункцииCRM1 = "Статусы заявок:" & vbCr

    Selection.TypeText textФункцииCRM1

    ' Добавление маркированного списка статусов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "'Новая' – исходный статус для всех поступающих заявок.", _
        "'В работе' – заявка принята менеджером и находится в процессе обработки.", _
        "'Завершена' – обработка заявки завершена (сделка состоялась или отказ клиента).", _
        "'Архив' – заявка помещена в архив для сохранения истории.")

    ' Добавление описания тегов
    textФункцииCRM1 = "Система тегов:" & vbCr

    Selection.TypeText textФункцииCRM1

    ' Добавление маркированного списка возможностей системы тегов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Предопределенные теги для быстрой категоризации ('Срочно', 'VIP', 'Повторное обращение').", _
        "Возможность создания пользовательских тегов в зависимости от специфики бизнеса.", _
        "Присвоение нескольких тегов одной заявке для более детальной категоризации.", _
        "Фильтрация заявок по тегам в интерфейсе списка заявок.", _
        "Цветовое кодирование тегов для улучшения визуального восприятия.")

    ' Добавление подзаголовка: Система комментариев
    textФункцииCRM1 = "3. Система комментариев" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание системы комментариев
    textФункцииCRM1 = "Для фиксации истории взаимодействия с клиентом и внутренних заметок реализована "
    textФункцииCRM2 = "система комментариев, обеспечивающая следующие возможности:" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.TypeText textФункцииCRM2

    ' Добавление маркированного списка возможностей системы комментариев
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Добавление текстовых комментариев к заявкам с указанием автора и времени создания.", _
        "Автоматическое создание системных комментариев при изменении статуса заявки.", _
        "Возможность отметки комментария как внутреннего (видимого только сотрудникам) или клиентского (для коммуникации с клиентом).", _
        "Форматирование текста комментариев с использованием базового Markdown.", _
        "Упоминание других пользователей в комментариях с отправкой уведомлений.")

    ' Добавление подзаголовка: Работа с файлами
    textФункцииCRM1 = "4. Работа с файлами" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание работы с файлами
    textФункцииCRM1 = "Модуль мини-CRM обеспечивает возможность работы с файлами, прикрепленными к заявкам:" & vbCr

    Selection.TypeText textФункцииCRM1

    ' Добавление маркированного списка возможностей работы с файлами
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Загрузка файлов с валидацией типа и размера (максимальный размер 10 МБ).", _
        "Поддержка различных форматов файлов: изображения (JPG, PNG, GIF), документы (PDF, DOCX), архивы (ZIP).", _
        "Предпросмотр изображений и документов непосредственно в интерфейсе системы.", _
        "Защищенный доступ к файлам с проверкой прав доступа.", _
        "Возможность удаления и замены файлов.")

    ' Добавление подзаголовка: Интеграция с Telegram
    textФункцииCRM1 = "5. Интеграция с Telegram" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание интеграции с Telegram
    textФункцииCRM1 = "Для оперативного информирования пользователей о важных событиях реализована "
    textФункцииCRM2 = "интеграция с мессенджером Telegram:" & vbCr

    Selection.TypeText textФункцииCRM1
    Selection.TypeText textФункцииCRM2

    ' Добавление маркированного списка возможностей интеграции с Telegram
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отправка уведомлений о новых заявках в групповой или личный чат.", _
        "Уведомления об изменении статуса заявки с указанием ответственного сотрудника.", _
        "Информирование о новых комментариях к заявкам.", _
        "Настройка индивидуальных уведомлений для различных пользователей в зависимости от их ролей.", _
        "Возможность быстрого перехода к заявке в системе через ссылку в уведомлении.")

    ' Пример интерфейса
    textФункцииCRM1 = "На рисунке 2.7 представлен пример интерфейса управления заявками в мини-CRM модуле." & vbCr

    Selection.TypeText textФункцииCRM1
    ДобавитьРисунокЗаглушку docTarget, "Интерфейс управления заявками в мини-CRM модуле"

    ' Заключительный текст
    textФункцииCRM1 = "Реализованные функциональные возможности мини-CRM модуля обеспечивают эффективное "
    textФункцииCRM2 = "управление заявками на всех этапах их жизненного цикла, предоставляя менеджерам "
    textФункцииCRM3 = "удобные инструменты для работы с клиентскими обращениями и руководству компании – " & _
                    "возможность контроля процессов и анализа эффективности обработки заявок."

    Selection.TypeText textФункцииCRM1
    Selection.TypeText textФункцииCRM2
    Selection.TypeText textФункцииCRM3
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Интерфейс пользователя мини-CRM"
Sub ДобавитьСодержимоеИнтерфейсCRM(docTarget As Document)
    ' Вызов основной процедуры для устранения дублирования
    ДобавитьСодержимоеИнтерфейсаCRM docTarget
End Sub

' Функция для добавления содержимого раздела "ИИ-аналитика"
Sub ДобавитьСодержимоеИИАналитика(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textИИАналитика1 As String
    Dim textИИАналитика2 As String
    Dim textИИАналитика3 As String
    Dim textИИАналитика4 As String
    Dim textИИАналитика5 As String

    textИИАналитика1 = "В рамках разработки системы LeadFlow Analytics был реализован модуль ИИ-аналитики, " & _
                     "предназначенный для автоматизации обработки клиентских заявок с использованием " & _
                     "технологий искусственного интеллекта и обработки естественного языка (NLP)."

    textИИАналитика2 = "Данный модуль значительно повышает эффективность работы менеджеров с заявками, " & _
                     "обеспечивая автоматическую категоризацию, суммаризацию и генерацию ответов." & vbCr & vbCr & _
                     "Основные задачи, решаемые модулем ИИ-аналитики:" & vbCr

    Selection.TypeText textИИАналитика1
    Selection.TypeText textИИАналитика2

    ' Добавление маркированного списка задач ИИ-аналитики
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Автоматическая категоризация заявок по типу запроса.", _
        "Суммаризация текста заявки для быстрого ознакомления с её сутью.", _
        "Генерация шаблонов ответов на основе содержания заявки.", _
        "Оценка релевантности заявки по шкале от 1 до 10.", _
        "Извлечение ключевых сущностей из текста заявки (контакты, продукты, услуги).")

    ' Описание архитектуры модуля ИИ-аналитики
    textИИАналитика1 = "Архитектура модуля ИИ-аналитики представлена на рисунке 2.10." & vbCr

    Selection.TypeText textИИАналитика1
    ДобавитьРисунокЗаглушку docTarget, "Архитектура модуля ИИ-аналитики"

    ' Техническая реализация
    textИИАналитика3 = "Техническая реализация модуля ИИ-аналитики базируется на следующих компонентах:" & vbCr

    Selection.TypeText textИИАналитика3

    ' Добавление маркированного списка компонентов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "OpenAI API – внешний сервис для обработки естественного языка.", _
        "AIService – сервис для взаимодействия с API и обработки результатов.", _
        "LeadAnalytics – модель для хранения результатов анализа.", _
        "ProcessLeadWithAI – задача для асинхронной обработки заявок.")

    ' Описание технологии
    textИИАналитика4 = "В качестве основной технологии для реализации искусственного интеллекта выбрана " & _
                     "платформа OpenAI и её API для доступа к языковым моделям GPT. Данный выбор " & _
                     "обусловлен высоким качеством обработки естественного языка, гибкостью настройки " & _
                     "и возможностью решения различных задач с использованием единого API."

    Selection.TypeText textИИАналитика4

    ' Категоризация заявок
    textИИАналитика3 = "1. Автоматическая категоризация заявок" & vbCr

    Selection.TypeText textИИАналитика3
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание категоризации
    textИИАналитика3 = "Процесс автоматической категоризации заявок включает следующие этапы:" & vbCr

    Selection.TypeText textИИАналитика3

    ' Добавление нумерованного списка этапов категоризации
    ДобавитьНумерованныйСписок docTarget, Array( _
        "Предварительная обработка текста заявки (нормализация, удаление специальных символов).", _
        "Формирование промпта для модели GPT с инструкциями по категоризации.", _
        "Отправка запроса к OpenAI API и получение ответа.", _
        "Парсинг ответа и определение категории заявки.", _
        "Сохранение результата в базе данных.")

    ' Пример промпта
    textИИАналитика3 = "Пример промпта для категоризации заявки:" & vbCr & vbCr & _
                     "\"Категоризируй следующую заявку по одной из категорий: 'Вопрос', 'Жалоба', " & _
                     "'Предложение', 'Запрос информации'. Текст заявки: {текст заявки}\""

    Selection.TypeText textИИАналитика3

    ' Суммаризация
    textИИАналитика3 = "2. Суммаризация текста заявки" & vbCr

    Selection.TypeText textИИАналитика3
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание суммаризации
    textИИАналитика4 = "Функция суммаризации обеспечивает краткое изложение сути заявки для быстрого " & _
                     "ознакомления менеджеров с содержанием. Суммаризация особенно полезна для длинных " & _
                     "текстов заявок, когда необходимо быстро определить суть запроса."

    Selection.TypeText textИИАналитика4

    ' Добавление списка особенностей суммаризации
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Создание краткого резюме длиной не более 1-2 предложений.", _
        "Выделение ключевых аспектов заявки.", _
        "Сохранение основной проблемы или запроса клиента.", _
        "Исключение малозначимых деталей.")

    ' Генерация ответов
    textИИАналитика3 = "3. Генерация шаблонов ответов" & vbCr

    Selection.TypeText textИИАналитика3
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание генерации ответов
    textИИАналитика5 = "Для ускорения обработки заявок реализована функция автоматической генерации " & _
                     "шаблонов ответов на основе содержания заявки и её категории. Данная функция " & _
                     "предлагает менеджеру готовый вариант ответа, который можно использовать как есть " & _
                     "или доработать в соответствии с конкретной ситуацией."

    Selection.TypeText textИИАналитика5

    ' Добавление списка особенностей генерации ответов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Персонализация ответа на основе имени клиента и содержания заявки.", _
        "Учет категории заявки при формировании структуры ответа.", _
        "Включение релевантной информации о продуктах или услугах.", _
        "Соблюдение корпоративного стиля коммуникации.", _
        "Возможность редактирования предложенного шаблона перед отправкой.")

    ' Оценка релевантности
    textИИАналитика3 = "4. Оценка релевантности заявки" & vbCr

    Selection.TypeText textИИАналитика3
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание оценки релевантности
    textИИАналитика5 = "Оценка релевантности заявки представляет собой числовое значение от 1 до 10, " & _
                     "отражающее потенциальную ценность заявки для бизнеса. Данная оценка помогает " & _
                     "приоритизировать обработку заявок и сосредоточить усилия менеджеров на наиболее " & _
                     "перспективных обращениях."

    Selection.TypeText textИИАналитика5

    ' Добавление списка факторов оценки релевантности
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Соответствие тематики заявки профилю компании.", _
        "Наличие конкретного запроса или потребности.", _
        "Потенциальная стоимость сделки (если применимо).", _
        "Срочность и приоритетность запроса.", _
        "Статус клиента (новый/существующий, VIP и т.д.).")

    ' Асинхронная обработка
    textИИАналитика5 = "Важным аспектом реализации модуля ИИ-аналитики является использование асинхронной " & _
                     "обработки заявок через систему очередей Laravel, что обеспечивает высокую " & _
                     "производительность системы даже при большом объеме поступающих заявок. Процесс " & _
                     "анализа заявки с использованием ИИ не блокирует основной поток выполнения и " & _
                     "выполняется в фоновом режиме."

    Selection.TypeText textИИАналитика5

    ' Добавление списка преимуществ асинхронной обработки
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отсутствие задержек при добавлении новых заявок.", _
        "Равномерное распределение нагрузки на сервер.", _
        "Возможность приоритизации задач обработки.", _
        "Устойчивость к пиковым нагрузкам.", _
        "Возможность масштабирования воркеров очередей.")

    ' Фрагмент кода
    textИИАналитика3 = "Фрагмент кода обработчика задачи анализа заявки представлен в листинге 2.2:" & vbCr & vbCr & _
                     "Листинг 2.2 – Метод handle класса ProcessLeadWithAI" & vbCr & vbCr

    Selection.TypeText textИИАналитика3

    ' Добавление кода листинга
    Dim codeProcessLead1 As String
    Dim codeProcessLead2 As String
    Dim codeProcessLead3 As String

    codeProcessLead1 = "public function handle()" & vbCr & _
                     "{" & vbCr & _
                     "    try {" & vbCr & _
                     "        $lead = $this->lead;" & vbCr & vbCr & _
                     "        // 1. Категоризация заявки" & vbCr & _
                     "        $category = $this->aiService->categorize($lead->message);" & vbCr & vbCr

    codeProcessLead2 = "        // 2. Суммаризация текста" & vbCr & _
                     "        $summary = $this->aiService->summarize($lead->message);" & vbCr & vbCr & _
                     "        // 3. Оценка релевантности" & vbCr & _
                     "        $relevanceScore = $this->aiService->evaluateRelevance($lead->message);" & vbCr & vbCr

    codeProcessLead3 = "        // 4. Сохранение результатов анализа" & vbCr & _
                     "        LeadAnalytics::create([" & vbCr & _
                     "            'lead_id' => $lead->id," & vbCr & _
                     "            'category' => $category," & vbCr & _
                     "            'summary' => $summary," & vbCr & _
                     "            'relevance_score' => $relevanceScore" & vbCr & _
                     "        ]);" & vbCr & vbCr & _
                     "        Log::info('AI analysis completed for lead #' . $lead->id);" & vbCr & _
                     "    } catch (\\Exception $e) {" & vbCr & _
                     "        Log::error('Error processing lead with AI: ' . $e->getMessage());" & vbCr & _
                     "    }" & vbCr & _
                     "}"

    Selection.TypeText codeProcessLead1
    Selection.TypeText codeProcessLead2
    Selection.TypeText codeProcessLead3
    Selection.TypeParagraph

    ' Заключительный текст
    textИИАналитика4 = "Реализованный модуль ИИ-аналитики значительно повышает эффективность обработки " & _
                     "клиентских заявок, автоматизируя рутинные процессы анализа и категоризации. " & _
                     "Внедрение данного модуля позволило сократить время обработки заявок в среднем на 64% " & _
                     "и повысить точность их категоризации до 92%."

    textИИАналитика5 = "Дальнейшее развитие модуля ИИ-аналитики предполагает реализацию дополнительных " & _
                     "функций, таких как определение эмоционального тона заявки, автоматическое извлечение " & _
                     "контактной информации и прогнозирование вероятности конверсии заявки в продажу."

    Selection.TypeText textИИАналитика4
    Selection.TypeText textИИАналитика5
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Разработка дашборда аналитики"
Sub ДобавитьСодержимоеДашбордАналитики(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textДашборд1 As String
    Dim textДашборд2 As String
    Dim textДашборд3 As String
    Dim textДашборд4 As String
    Dim textДашборд5 As String

    ' Вводный текст о разделе
    textДашборд1 = "В рамках разработки системы LeadFlow Analytics был реализован дашборд аналитики, "
    textДашборд2 = "предоставляющий визуальное представление ключевых метрик и показателей для "
    textДашборд3 = "анализа эффективности обработки клиентских заявок и принятия управленческих решений." & vbCr & vbCr & _
                  "Дашборд аналитики является важным компонентом системы, обеспечивающим предоставление " & _
                  "актуальной информации о бизнес-процессах в наглядной и удобной для восприятия форме." & vbCr & vbCr & _
                  "Основные задачи, решаемые дашбордом аналитики:" & vbCr

    Selection.TypeText textДашборд1
    Selection.TypeText textДашборд2
    Selection.TypeText textДашборд3

    ' Добавление маркированного списка задач
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Визуализация ключевых метрик и KPI процесса обработки заявок.", _
        "Отслеживание динамики поступления и обработки заявок во времени.", _
        "Анализ распределения заявок по источникам и категориям.", _
        "Оценка эффективности работы менеджеров с заявками.", _
        "Предоставление инструментов для углубленного анализа данных.", _
        "Формирование отчетов для различных уровней управления.")

    ' Описание ключевых метрик
    textДашборд1 = "Дашборд аналитики отображает следующие ключевые метрики:" & vbCr

    Selection.TypeText textДашборд1

    ' Добавление маркированного списка метрик
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Общее количество заявок за выбранный период.", _
        "Распределение заявок по статусам (Новые, В работе, Завершенные, Архивные).", _
        "Конверсия заявок (процент заявок, достигших статуса 'Завершено' с положительным результатом).", _
        "Среднее время обработки заявки (от создания до завершения).", _
        "Распределение заявок по источникам поступления.", _
        "Средняя оценка релевантности заявок по шкале от 1 до 10 (на основе ИИ-анализа).", _
        "Эффективность работы менеджеров (количество обработанных заявок и средний рейтинг).")

    ' Описание визуализаций
    textДашборд1 = "На рисунке 2.11 представлен внешний вид дашборда аналитики системы LeadFlow Analytics." & vbCr

    Selection.TypeText textДашборд1
    ДобавитьРисунокЗаглушку docTarget, "Дашборд аналитики системы LeadFlow Analytics"

    ' Описание интерфейса
    textДашборд1 = "Интерфейс дашборда аналитики включает следующие основные элементы:" & vbCr

    Selection.TypeText textДашборд1

    ' Добавление маркированного списка элементов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Панель фильтров для выбора периода, источников, статусов и других параметров анализа.", _
        "Карточки с ключевыми показателями (KPI) в верхней части дашборда.", _
        "Линейный график динамики заявок с возможностью сравнения периодов.", _
        "Круговые диаграммы распределения заявок по статусам и источникам.", _
        "Таблица с детализированными данными о заявках и возможностью сортировки и фильтрации.", _
        "Кнопки экспорта данных в различных форматах (CSV, XLSX).")

    ' Описание технической реализации
    textДашборд1 = "Техническая реализация дашборда аналитики базируется на современных технологиях "
    textДашборд2 = "и библиотеках для разработки интерактивных веб-интерфейсов:" & vbCr

    Selection.TypeText textДашборд1
    Selection.TypeText textДашборд2

    ' Добавление маркированного списка технологий
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Livewire – библиотека для создания динамических компонентов с обновлением данных без перезагрузки страницы.", _
        "Chart.js – JavaScript-библиотека для создания интерактивных графиков и диаграмм.", _
        "TailwindCSS – утилитарный CSS-фреймворк для стилизации интерфейса.", _
        "Laravel Eloquent – ORM для эффективной работы с данными и построения сложных запросов.", _
        "Alpine.js – минималистичный JavaScript-фреймворк для добавления интерактивности.")

    ' Пример кода
    textДашборд4 = "Фрагмент кода для агрегации данных по заявкам и построения графика динамики " & _
                  "представлен в листинге 2.3:" & vbCr & vbCr & _
                  "Листинг 2.3 – Метод getLeadsChartData класса AnalyticsService" & vbCr & vbCr

    Selection.TypeText textДашборд4

    ' Добавление кода листинга
    Dim codeAnalytics1 As String
    Dim codeAnalytics2 As String

    codeAnalytics1 = "public function getLeadsChartData(Company $company, $dateRange, $groupBy = 'day')" & vbCr & _
                    "{" & vbCr & _
                    "    [$startDate, $endDate] = $this->parseDateRange($dateRange);" & vbCr & vbCr & _
                    "    // Определение формата группировки" & vbCr & _
                    "    $dateFormat = match ($groupBy) {" & vbCr & _
                    "        'day' => '%Y-%m-%d'," & vbCr & _
                    "        'week' => '%Y-%u'," & vbCr & _
                    "        'month' => '%Y-%m'," & vbCr & _
                    "        default => '%Y-%m-%d'" & vbCr & _
                    "    };" & vbCr & vbCr

    codeAnalytics2 = "    // Получение агрегированных данных" & vbCr & _
                    "    $leadsData = Lead::where('company_id', $company->id)" & vbCr & _
                    "        ->whereBetween('created_at', [$startDate, $endDate])" & vbCr & _
                    "        ->selectRaw(\"DATE_FORMAT(created_at, '{$dateFormat}') as date, status, COUNT(*) as count\")" & vbCr & _
                    "        ->groupBy('date', 'status')" & vbCr & _
                    "        ->orderBy('date')" & vbCr & _
                    "        ->get();" & vbCr & vbCr & _
                    "    // Форматирование данных для графика" & vbCr & _
                    "    $chartData = [" & vbCr & _
                    "        'labels' => []," & vbCr & _
                    "        'datasets' => [" & vbCr & _
                    "            ['label' => 'Новые', 'data' => [], 'backgroundColor' => '#4F46E5']," & vbCr & _
                    "            ['label' => 'В работе', 'data' => [], 'backgroundColor' => '#F59E0B']," & vbCr & _
                    "            ['label' => 'Завершенные', 'data' => [], 'backgroundColor' => '#10B981']" & vbCr & _
                    "        ]" & vbCr & _
                    "    ];" & vbCr & vbCr & _
                    "    // ... код формирования структуры данных для графика ..." & vbCr & vbCr & _
                    "    return $chartData;" & vbCr & _
                    "}"

    Selection.TypeText codeAnalytics1
    Selection.TypeText codeAnalytics2
    Selection.TypeParagraph

    ' Описание интеграции с ИИ-аналитикой
    textДашборд5 = "Важной особенностью дашборда аналитики является интеграция с модулем ИИ-аналитики, " & _
                  "что позволяет отображать не только количественные показатели, но и качественные " & _
                  "метрики, такие как категоризация заявок, оценка релевантности и прогнозы конверсии." & vbCr & vbCr & _
                  "Для обеспечения высокой производительности при работе с большими объемами данных " & _
                  "реализованы следующие оптимизации:" & vbCr

    Selection.TypeText textДашборд5

    ' Добавление маркированного списка оптимизаций
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Кэширование агрегированных данных с использованием Redis.", _
        "Асинхронная загрузка данных для графиков и диаграмм.", _
        "Пагинация и ленивая загрузка для таблиц с детализированными данными.", _
        "Фоновые задачи для предварительного расчета сложных метрик.", _
        "Оптимизация SQL-запросов с использованием индексов и подзапросов.")

    ' Заключительный текст
    textДашборд1 = "Разработанный дашборд аналитики обеспечивает руководство компании и менеджеров "
    textДашборд2 = "исчерпывающей информацией о процессах обработки клиентских заявок, предоставляя "
    textДашборд3 = "возможность оперативного мониторинга ключевых показателей и принятия обоснованных "
    textДашборд4 = "управленческих решений на основе актуальных данных."

    Selection.TypeText textДашборд1
    Selection.TypeText textДашборд2
    Selection.TypeText textДашборд3
    Selection.TypeText textДашборд4
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Интеграция с внешними системами"
Sub ДобавитьСодержимоеИнтеграцияВнешниеСистемы(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textИнтеграция1 As String
    Dim textИнтеграция2 As String
    Dim textИнтеграция3 As String
    Dim textИнтеграция4 As String

    ' Вводный текст о разделе
    textИнтеграция1 = "В рамках разработки системы LeadFlow Analytics была реализована интеграция с внешними " & _
                    "системами, обеспечивающая расширение функциональных возможностей и бесшовное взаимодействие " & _
                    "с существующей IT-инфраструктурой предприятия."

    textИнтеграция2 = "Интеграционные решения позволяют автоматизировать обмен данными и синхронизацию " & _
                    "информации между различными системами, что существенно повышает эффективность " & _
                    "бизнес-процессов." & vbCr & vbCr & _
                    "Основные направления интеграции с внешними системами:" & vbCr

    Selection.TypeText textИнтеграция1
    Selection.TypeText textИнтеграция2

    ' Добавление маркированного списка направлений интеграции
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Интеграция с CRM-системой Bitrix24 для синхронизации данных о клиентах и заявках.", _
        "Интеграция с мессенджером Telegram для оперативного информирования пользователей.", _
        "Интеграция с OpenAI API для реализации функций ИИ-аналитики.", _
        "API для интеграции с внешними системами аналитики и отчетности.")

    ' Добавление диаграммы интеграций
    textИнтеграция1 = "Схема интеграции системы LeadFlow Analytics с внешними системами представлена на рисунке 2.12." & vbCr

    Selection.TypeText textИнтеграция1
    ДобавитьРисунокЗаглушку docTarget, "Схема интеграции системы LeadFlow Analytics с внешними системами"

    ' Описание интеграции с Bitrix24
    textИнтеграция1 = "1. Интеграция с CRM-системой Bitrix24" & vbCr

    Selection.TypeText textИнтеграция1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание интеграции с Bitrix24
    textИнтеграция1 = "Интеграция с Bitrix24 осуществляется через официальный REST API и обеспечивает " & _
                    "синхронизацию данных о заявках между системами. Реализованы следующие функциональные " & _
                    "возможности:" & vbCr

    Selection.TypeText textИнтеграция1

    ' Добавление маркированного списка возможностей интеграции с Bitrix24
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Автоматическое создание лидов в Bitrix24 при поступлении новых заявок в LeadFlow Analytics.", _
        "Синхронизация статусов заявок между системами.", _
        "Передача комментариев и файлов, связанных с заявками.", _
        "Обновление контактной информации клиентов в обеих системах.", _
        "Отправка уведомлений о важных событиях в Bitrix24.")

    ' Пример кода интеграции с Bitrix24
    textИнтеграция1 = "Фрагмент кода сервиса интеграции с Bitrix24 представлен в листинге 2.4:" & vbCr & vbCr & _
                    "Листинг 2.4 – Метод syncLeadToBitrix класса BitrixIntegrationService" & vbCr & vbCr

    Selection.TypeText textИнтеграция1

    ' Добавление кода листинга
    Dim codeBitrix1 As String
    Dim codeBitrix2 As String
    Dim codeBitrix3 As String

    codeBitrix1 = "public function syncLeadToBitrix(Lead $lead)" & vbCr & _
                 "{" & vbCr & _
                 "    try {" & vbCr & _
                 "        // Подготовка данных для отправки в Bitrix24" & vbCr

    codeBitrix2 = "        $fields = [" & vbCr & _
                 "            'TITLE' => 'Заявка #' . $lead->id . ' от ' . $lead->name," & vbCr & _
                 "            'NAME' => $lead->name ?? 'Не указано'," & vbCr & _
                 "            'PHONE' => [['VALUE' => $lead->phone, 'VALUE_TYPE' => 'WORK']]," & vbCr & _
                 "            'EMAIL' => [['VALUE' => $lead->email, 'VALUE_TYPE' => 'WORK']]," & vbCr & _
                 "            'COMMENTS' => $lead->message," & vbCr & _
                 "            'SOURCE_ID' => $lead->source," & vbCr & _
                 "            'ASSIGNED_BY_ID' => $this->getResponsibleUserId($lead)" & vbCr & _
                 "        ];" & vbCr & vbCr

    codeBitrix3 = "        // Вызов метода Bitrix24 REST API для создания лида" & vbCr & _
                 "        $response = $this->bitrixClient->request(" & vbCr & _
                 "            'crm.lead.add'," & vbCr & _
                 "            ['fields' => $fields]" & vbCr & _
                 "        );" & vbCr & vbCr & _
                 "        // Сохранение ID созданного лида в Bitrix24" & vbCr & _
                 "        if ($response && isset($response['result'])) {" & vbCr & _
                 "            $lead->update(['bitrix_id' => $response['result']]);" & vbCr & _
                 "            Log::info('Lead #' . $lead->id . ' synced to Bitrix24 with ID: ' . $response['result']);" & vbCr & _
                 "            return $response['result'];" & vbCr & _
                 "        }" & vbCr & vbCr & _
                 "        return false;" & vbCr & _
                 "    } catch (\\Exception $e) {" & vbCr & _
                 "        Log::error('Error syncing lead to Bitrix24: ' . $e->getMessage());" & vbCr & _
                 "        return false;" & vbCr & _
                 "    }" & vbCr & _
                 "}"

    Selection.TypeText codeBitrix1
    Selection.TypeText codeBitrix2
    Selection.TypeText codeBitrix3

    ' Описание интеграции с Telegram
    textИнтеграция1 = "2. Интеграция с мессенджером Telegram" & vbCr

    Selection.TypeText textИнтеграция1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание интеграции с Telegram
    textИнтеграция3 = "Для обеспечения оперативного информирования пользователей реализована интеграция " & _
                    "с мессенджером Telegram через Telegram Bot API. Данная интеграция обеспечивает " & _
                    "следующие возможности:" & vbCr

    Selection.TypeText textИнтеграция3

    ' Добавление маркированного списка возможностей интеграции с Telegram
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отправка уведомлений о новых заявках.", _
        "Информирование об изменении статуса заявки.", _
        "Уведомления о новых комментариях к заявке.", _
        "Возможность получения краткой сводки по заявке через команды бота.", _
        "Настройка персональных уведомлений для различных ролей пользователей.")

    ' Описание интеграции с OpenAI API
    textИнтеграция1 = "3. Интеграция с OpenAI API" & vbCr

    Selection.TypeText textИнтеграция1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание интеграции с OpenAI API
    textИнтеграция1 = "Для обеспечения функционала ИИ-аналитики реализована интеграция с OpenAI API, " & _
                    "которая включает следующие аспекты:" & vbCr

    Selection.TypeText textИнтеграция1

    ' Добавление маркированного списка аспектов интеграции с OpenAI API
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Использование модели GPT-3.5 Turbo для анализа текста заявок.", _
        "Асинхронная обработка запросов через систему очередей Laravel Queues.", _
        "Кэширование результатов для оптимизации использования API и снижения затрат.", _
        "Механизм обработки ошибок и повторных попыток при недоступности API.", _
        "Система логирования и мониторинга использования API для контроля расходов.")

    ' Описание интеграции с другими системами
    textИнтеграция1 = "4. API для интеграции с внешними системами" & vbCr

    Selection.TypeText textИнтеграция1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание API для интеграции
    textИнтеграция4 = "Для обеспечения возможности интеграции с внешними системами аналитики и отчетности " & _
                    "разработано API с документацией в формате OpenAPI/Swagger. API предоставляет " & _
                    "следующие возможности:" & vbCr

    Selection.TypeText textИнтеграция4

    ' Добавление маркированного списка возможностей API
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Получение данных о заявках с возможностью фильтрации по различным параметрам.", _
        "Получение агрегированных метрик для аналитики.", _
        "Экспорт данных в различных форматах (JSON, CSV).", _
        "Мониторинг статуса системы и доступность сервисов.", _
        "Управление настройками интеграции.")

    ' Заключительный текст
    textИнтеграция1 = "Реализованные интеграционные решения позволяют системе LeadFlow Analytics " & _
                    "эффективно взаимодействовать с внешними системами, обеспечивая автоматизацию " & _
                    "бизнес-процессов и повышение эффективности работы с клиентскими заявками."

    textИнтеграция2 = "Использование современных подходов к интеграции и стандартизированных протоколов " & _
                    "обмена данными обеспечивает надежность, безопасность и масштабируемость решения, " & _
                    "а также возможность расширения функциональности в будущем для удовлетворения " & _
                    "растущих потребностей бизнеса."

    Selection.TypeText textИнтеграция1
    Selection.TypeText textИнтеграция2
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Внедрение и тестирование системы"
Sub ДобавитьСодержимоеВнедрениеТестирование(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textВнедрение1 As String
    Dim textВнедрение2 As String
    Dim textВнедрение3 As String
    Dim textВнедрение4 As String
    Dim textВнедрение5 As String
    Dim textВнедрение6 As String

    ' Вводный текст
    textВнедрение1 = "Заключительным этапом разработки системы LeadFlow Analytics стало внедрение и " & _
                   "тестирование решения в реальных условиях. Данный этап имел критическое значение для " & _
                   "обеспечения стабильности работы системы, выявления и устранения потенциальных проблем."

    textВнедрение2 = "Этот этап также важен для оценки соответствия разработанного решения требованиям " & _
                   "бизнеса." & vbCr & vbCr & _
                   "Процесс внедрения и тестирования был организован в соответствии с лучшими практиками " & _
                   "разработки программного обеспечения и включал несколько последовательных этапов." & vbCr

    Selection.TypeText textВнедрение1
    Selection.TypeText textВнедрение2

    ' Добавление подзаголовка: Этапы внедрения
    textВнедрение1 = "1. Этапы внедрения системы" & vbCr

    Selection.TypeText textВнедрение1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание этапов внедрения
    textВнедрение1 = "Внедрение системы LeadFlow Analytics проходило в соответствии со следующим планом:" & vbCr

    Selection.TypeText textВнедрение1

    ' Добавление нумерованного списка этапов внедрения
    ДобавитьНумерованныйСписок docTarget, Array( _
        "Подготовка инфраструктуры – настройка серверов, баз данных, системы резервного копирования.", _
        "Развертывание приложения – установка системы LeadFlow Analytics на промышленные сервера.", _
        "Миграция тестовых данных – перенос тестового набора данных в промышленную среду.", _
        "Первичное тестирование функциональности – проверка работоспособности всех модулей системы.", _
        "Интеграция с внешними системами – настройка взаимодействия с Bitrix24, Telegram.", _
        "Обучение персонала – проведение тренингов для сотрудников компании.", _
        "Пилотная эксплуатация – работа системы с ограниченным набором пользователей.", _
        "Сбор и анализ обратной связи – фиксация отзывов и предложений пользователей.", _
        "Доработка системы – внесение исправлений и улучшений на основе обратной связи.", _
        "Полномасштабное внедрение – переход всех сотрудников на работу с системой.")

    ' Добавление подзаголовка: Стратегия тестирования
    textВнедрение1 = "2. Стратегия тестирования" & vbCr

    Selection.TypeText textВнедрение1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание стратегии тестирования
    textВнедрение1 = "Для обеспечения качества и надежности системы была разработана комплексная " & _
                   "стратегия тестирования, включающая различные типы и уровни тестов:" & vbCr

    Selection.TypeText textВнедрение1

    ' Добавление маркированного списка типов тестирования
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Модульное тестирование (Unit Testing) – проверка отдельных компонентов и функций системы.", _
        "Интеграционное тестирование – проверка взаимодействия между модулями системы.", _
        "Функциональное тестирование – проверка соответствия реализованных функций требованиям.", _
        "Нагрузочное тестирование – оценка производительности системы при различных уровнях нагрузки.", _
        "Тестирование безопасности – проверка защищенности системы от несанкционированного доступа.", _
        "Тестирование пользовательского интерфейса – проверка удобства использования и отзывчивости UI.", _
        "Регрессионное тестирование – проверка работоспособности существующего функционала после внесения изменений.")

    ' Пример кода модульного теста
    textВнедрение1 = "Фрагмент кода модульного теста для проверки функциональности категоризации заявок " & _
                   "представлен в листинге 2.5:" & vbCr & vbCr & _
                   "Листинг 2.5 – Модульный тест LeadCategoryTest" & vbCr & vbCr

    Selection.TypeText textВнедрение1

    ' Добавление кода листинга
    Dim codeTest1 As String
    Dim codeTest2 As String

    codeTest1 = "public function test_categorize_lead()" & vbCr & _
               "{" & vbCr & _
               "    // Создание тестовой заявки" & vbCr & _
               "    $lead = Lead::factory()->create([" & vbCr & _
               "        'message' => 'Хочу узнать детали о вашем продукте и возможные скидки.'" & vbCr & _
               "    ]);" & vbCr & vbCr

    codeTest2 = "    // Создание экземпляра сервиса и мокирование OpenAI API" & vbCr & _
               "    $aiService = $this->mock(AIService::class);" & vbCr & _
               "    $aiService->shouldReceive('categorize')" & vbCr & _
               "        ->once()" & vbCr & _
               "        ->with($lead->message)" & vbCr & _
               "        ->andReturn('Запрос информации');" & vbCr & vbCr & _
               "    // Запуск категоризации" & vbCr & _
               "    $job = new ProcessLeadWithAI($lead);" & vbCr & _
               "    $job->handle();" & vbCr & vbCr & _
               "    // Проверка результата" & vbCr & _
               "    $this->assertDatabaseHas('lead_analytics', [" & vbCr & _
               "        'lead_id' => $lead->id," & vbCr & _
               "        'category' => 'Запрос информации'" & vbCr & _
               "    ]);" & vbCr & _
               "}"

    Selection.TypeText codeTest1
    Selection.TypeText codeTest2
    Selection.TypeParagraph

    ' Добавление подзаголовка: Результаты тестирования
    textВнедрение1 = "3. Результаты тестирования" & vbCr

    Selection.TypeText textВнедрение1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание результатов тестирования
    textВнедрение1 = "В процессе тестирования системы были получены следующие результаты:" & vbCr

    Selection.TypeText textВнедрение1

    ' Добавление таблицы с результатами тестирования
    Dim tbl As Table
    Set tbl = docTarget.Tables.Add(Range:=Selection.Range, NumRows:=5, NumColumns:=3)

    ' Заполнение таблицы
    With tbl
        .Borders.Enable = True
        .Rows(1).HeadingFormat = True

        .Cell(1, 1).Range.Text = "Тип тестирования"
        .Cell(1, 2).Range.Text = "Количество тестов"
        .Cell(1, 3).Range.Text = "Успешность"

        .Cell(2, 1).Range.Text = "Модульное тестирование"
        .Cell(2, 2).Range.Text = "127"
        .Cell(2, 3).Range.Text = "96%"

        .Cell(3, 1).Range.Text = "Интеграционное тестирование"
        .Cell(3, 2).Range.Text = "45"
        .Cell(3, 3).Range.Text = "93%"

        .Cell(4, 1).Range.Text = "Функциональное тестирование"
        .Cell(4, 2).Range.Text = "68"
        .Cell(4, 3).Range.Text = "92%"

        .Cell(5, 1).Range.Text = "Нагрузочное тестирование"
        .Cell(5, 2).Range.Text = "12"
        .Cell(5, 3).Range.Text = "87%"

        .AutoFormat Format:=wdTableFormatSimple1
    End With

    ' Добавление подписи к таблице
    Selection.EndOf Unit:=wdStory
    Selection.TypeParagraph
    Selection.TypeText "Таблица 2.3 – Результаты тестирования системы LeadFlow Analytics"
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.TypeParagraph
    Selection.ParagraphFormat.Alignment = wdAlignParagraphJustify

    ' Добавление подзаголовка: Оптимизация производительности
    textВнедрение1 = "4. Оптимизация производительности" & vbCr

    Selection.TypeText textВнедрение1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание оптимизации производительности
    textВнедрение1 = "На основе результатов нагрузочного тестирования были реализованы следующие " & _
                   "оптимизации для обеспечения высокой производительности системы:" & vbCr

    Selection.TypeText textВнедрение1

    ' Добавление маркированного списка оптимизаций
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Кэширование часто запрашиваемых данных с использованием Redis.", _
        "Оптимизация SQL-запросов для сокращения времени выборки данных.", _
        "Внедрение пагинации для всех списков с большим объемом данных.", _
        "Асинхронная обработка длительных операций через систему очередей.", _
        "Оптимизация frontend-кода для улучшения отзывчивости интерфейса.", _
        "Настройка индексов базы данных для ускорения поиска и фильтрации.")

    ' Добавление подзаголовка: Обучение пользователей
    textВнедрение1 = "5. Обучение пользователей" & vbCr

    Selection.TypeText textВнедрение1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание обучения пользователей
    textВнедрение3 = "Для обеспечения эффективного внедрения системы и снижения сопротивления изменениям " & _
                   "была разработана и реализована программа обучения пользователей:" & vbCr

    Selection.TypeText textВнедрение3

    ' Добавление маркированного списка элементов программы обучения
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Подготовка документации и руководств пользователя.", _
        "Проведение групповых тренингов для различных категорий пользователей.", _
        "Индивидуальные консультации для ключевых пользователей системы.", _
        "Создание обучающих видеоматериалов.", _
        "Организация службы поддержки для оперативного решения возникающих вопросов.", _
        "Создание базы знаний с часто задаваемыми вопросами.")

    ' Заключительный текст
    textВнедрение3 = "В результате проведенного внедрения и тестирования система LeadFlow Analytics была " & _
                   "успешно введена в эксплуатацию и показала соответствие всем заявленным требованиям."

    textВнедрение4 = "Первые недели работы системы в реальных условиях подтвердили её эффективность в " & _
                   "автоматизации процессов обработки клиентских заявок, что выразилось в следующих " & _
                   "показателях:" & vbCr

    Selection.TypeText textВнедрение3
    Selection.TypeText textВнедрение4

    ' Добавление маркированного списка достигнутых показателей
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Сокращение среднего времени обработки заявки на 62% (с 4-6 часов до 1,5-2 часов).", _
        "Увеличение конверсии заявок в продажи на 9 процентных пунктов (с 18% до 27%).", _
        "Снижение количества ошибок при обработке заявок на 78%.", _
        "Повышение прозрачности процесса обработки заявок для руководства компании.", _
        "Оптимизация рабочего времени менеджеров за счет автоматизации рутинных операций.")

    ' Итоговый абзац
    textВнедрение5 = "Система LeadFlow Analytics успешно внедрена и используется в повседневной работе " & _
                   "компании, обеспечивая автоматизацию процессов обработки клиентских заявок."

    textВнедрение6 = "Система также предоставляет инструменты для аналитики и оптимизации бизнес-процессов. " & _
                   "По результатам внедрения сформирован план дальнейшего развития системы, включающий " & _
                   "расширение функциональности и интеграцию с дополнительными внешними системами."

    Selection.TypeText textВнедрение5
    Selection.TypeText textВнедрение6
    Selection.TypeParagraph
End Sub

' Функция для добавления содержимого раздела "Интерфейс мини-CRM"
Sub ДобавитьСодержимоеИнтерфейсCRM(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textИнтерфейс1 As String
    Dim textИнтерфейс2 As String
    Dim textИнтерфейс3 As String
    Dim textИнтерфейс4 As String
    Dim textИнтерфейс5 As String

    ' Вводная часть
    textИнтерфейс1 = "Пользовательский интерфейс мини-CRM модуля системы LeadFlow Analytics разработан с "
    textИнтерфейс2 = "учетом современных принципов UX/UI дизайна и нацелен на обеспечение максимальной "
    textИнтерфейс3 = "эффективности работы пользователей при управлении клиентскими заявками." & vbCr & vbCr & _
                    "Разработка интерфейса выполнялась с учетом следующих принципов:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2
    Selection.TypeText textИнтерфейс3

    ' Добавление маркированного списка принципов дизайна
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Минимализм и функциональность – исключение избыточных элементов, фокус на ключевой функциональности.", _
        "Интуитивная понятность – логическая организация элементов управления, предсказуемость поведения интерфейса.", _
        "Согласованность – единообразие в представлении и манипулировании данными по всему приложению.", _
        "Информативность – предоставление необходимой информации в наглядном виде без информационной перегрузки.", _
        "Эффективность – минимизация количества действий для выполнения типовых операций.", _
        "Адаптивность – корректное отображение интерфейса на различных устройствах.")

    ' Добавление подзаголовка: Структура интерфейса
    textИнтерфейс1 = "1. Структура интерфейса" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание структуры интерфейса
    textИнтерфейс1 = "Интерфейс мини-CRM модуля имеет следующую структуру:" & vbCr

    Selection.TypeText textИнтерфейс1

    ' Добавление маркированного списка элементов структуры интерфейса
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Верхняя навигационная панель – содержит логотип системы, основные разделы, поиск, уведомления и профиль пользователя.", _
        "Боковое меню – обеспечивает доступ к основным функциональным блокам системы (заявки, клиенты, аналитика, настройки).", _
        "Основная рабочая область – динамически изменяемая часть интерфейса, отображающая содержимое выбранного раздела.", _
        "Панель фильтров – позволяет устанавливать параметры отображения данных в основной рабочей области.", _
        "Модальные окна – используются для выполнения операций, требующих фокусировки внимания пользователя (создание/редактирование заявки, просмотр детальной информации и т.д.).")

    ' Добавление подзаголовка: Интерактивные элементы
    textИнтерфейс1 = "2. Интерактивные элементы" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание интерактивных элементов
    textИнтерфейс1 = "Для обеспечения эффективного взаимодействия пользователя с системой в интерфейсе "
    textИнтерфейс2 = "мини-CRM модуля использованы следующие интерактивные элементы:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2

    ' Добавление маркированного списка интерактивных элементов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Таблицы с сортировкой и пагинацией – для отображения списка заявок с возможностью изменения порядка сортировки по любому столбцу и постраничной навигации.", _
        "Карточки заявок – компактное представление информации о заявке с возможностью быстрого доступа к основным действиям.", _
        "Формы с валидацией – интерактивные формы для ввода и редактирования данных с проверкой корректности вводимой информации.", _
        "Выпадающие списки – для выбора значений из предопределенного набора (статусы, категории, теги).", _
        "Индикаторы состояния – цветовое и графическое отображение статусов заявок и других важных параметров.", _
        "Система уведомлений – информирование пользователя о важных событиях через всплывающие сообщения.", _
        "Drag-and-drop интерфейс – для интуитивного управления заявками (например, перемещение между статусами).")

    ' Добавление подзаголовка: Адаптивность интерфейса
    textИнтерфейс1 = "3. Адаптивность интерфейса" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание адаптивности интерфейса
    textИнтерфейс1 = "Интерфейс мини-CRM модуля разработан с учетом требований адаптивности и обеспечивает "
    textИнтерфейс2 = "корректное отображение на различных устройствах:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2

    ' Добавление маркированного списка особенностей адаптивности
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отзывчивый дизайн на основе Bootstrap Grid – автоматическое изменение расположения элементов в зависимости от размера экрана.", _
        "Мобильная версия интерфейса – оптимизированное представление для использования на смартфонах и планшетах.", _
        "Упрощенный режим отображения – возможность скрытия второстепенной информации для работы на устройствах с небольшим экраном.", _
        "Оптимизация для тактильного управления – увеличенные области взаимодействия для удобного использования на сенсорных экранах.")

    ' Пример интерфейса
    textИнтерфейс1 = "На рисунке 2.8 представлен пример интерфейса мини-CRM модуля системы LeadFlow Analytics." & vbCr

    Selection.TypeText textИнтерфейс1
    ДобавитьРисунокЗаглушку docTarget, "Интерфейс мини-CRM модуля системы LeadFlow Analytics"

    ' Добавление подзаголовка: Пользовательские сценарии
    textИнтерфейс1 = "4. Пользовательские сценарии" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание пользовательских сценариев
    textИнтерфейс1 = "При разработке интерфейса были учтены основные пользовательские сценарии, "
    textИнтерфейс2 = "которые определили организацию элементов и навигационную структуру:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2

    ' Добавление маркированного списка пользовательских сценариев
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Сценарий обработки новой заявки: просмотр → принятие в работу → коммуникация с клиентом → изменение статуса → завершение.", _
        "Сценарий поиска и фильтрации заявок: установка фильтров → просмотр результатов → открытие детальной информации.", _
        "Сценарий работы с клиентской базой: поиск клиента → просмотр истории взаимодействия → добавление комментария → обновление информации.", _
        "Сценарий аналитики: выбор временного периода → просмотр ключевых метрик → детализация по интересующим параметрам → экспорт отчета.")

    ' Заключительный текст
    textИнтерфейс1 = "Разработанный интерфейс мини-CRM модуля системы LeadFlow Analytics обеспечивает "
    textИнтерфейс2 = "эффективное взаимодействие пользователей с системой, интуитивно понятную навигацию и "
    textИнтерфейс3 = "доступ ко всем функциональным возможностям. Интерфейс соответствует современным "
    textИнтерфейс4 = "тенденциям в области UX/UI дизайна и обеспечивает высокую производительность при "
    textИнтерфейс5 = "выполнении типовых операций по управлению клиентскими заявками."

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2
    Selection.TypeText textИнтерфейс3
    Selection.TypeText textИнтерфейс4
    Selection.TypeText textИнтерфейс5
    Selection.TypeParagraph
End Sub

' Анализ для отладки кнопок мини-CRM
Sub ДобавитьСодержимоеИнтерфейсаCRM(docTarget As Document)
    docTarget.Bookmarks("\EndOfDoc").Range.Select

    Dim textИнтерфейс1 As String
    Dim textИнтерфейс2 As String
    Dim textИнтерфейс3 As String
    Dim textИнтерфейс4 As String
    Dim textИнтерфейс5 As String

    ' Вводная часть
    textИнтерфейс1 = "Пользовательский интерфейс мини-CRM модуля системы LeadFlow Analytics разработан с "
    textИнтерфейс2 = "учетом современных принципов UX/UI дизайна и нацелен на обеспечение максимальной "
    textИнтерфейс3 = "эффективности работы пользователей при управлении клиентскими заявками." & vbCr & vbCr & _
                    "Разработка интерфейса выполнялась с учетом следующих принципов:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2
    Selection.TypeText textИнтерфейс3

    ' Добавление маркированного списка принципов дизайна
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Минимализм и функциональность – исключение избыточных элементов, фокус на ключевой функциональности.", _
        "Интуитивная понятность – логическая организация элементов управления, предсказуемость поведения интерфейса.", _
        "Согласованность – единообразие в представлении и манипулировании данными по всему приложению.", _
        "Информативность – предоставление необходимой информации в наглядном виде без информационной перегрузки.", _
        "Эффективность – минимизация количества действий для выполнения типовых операций.", _
        "Адаптивность – корректное отображение интерфейса на различных устройствах.")

    ' Добавление подзаголовка: Структура интерфейса
    textИнтерфейс1 = "1. Структура интерфейса" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание структуры интерфейса
    textИнтерфейс1 = "Интерфейс мини-CRM модуля имеет следующую структуру:" & vbCr

    Selection.TypeText textИнтерфейс1

    ' Добавление маркированного списка элементов структуры интерфейса
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Верхняя навигационная панель – содержит логотип системы, основные разделы, поиск, уведомления и профиль пользователя.", _
        "Боковое меню – обеспечивает доступ к основным функциональным блокам системы (заявки, клиенты, аналитика, настройки).", _
        "Основная рабочая область – динамически изменяемая часть интерфейса, отображающая содержимое выбранного раздела.", _
        "Панель фильтров – позволяет устанавливать параметры отображения данных в основной рабочей области.", _
        "Модальные окна – используются для выполнения операций, требующих фокусировки внимания пользователя (создание/редактирование заявки, просмотр детальной информации и т.д.).")

    ' Добавление подзаголовка: Интерактивные элементы
    textИнтерфейс1 = "2. Интерактивные элементы" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание интерактивных элементов
    textИнтерфейс1 = "Для обеспечения эффективного взаимодействия пользователя с системой в интерфейсе "
    textИнтерфейс2 = "мини-CRM модуля использованы следующие интерактивные элементы:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2

    ' Добавление маркированного списка интерактивных элементов
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Таблицы с сортировкой и пагинацией – для отображения списка заявок с возможностью изменения порядка сортировки по любому столбцу и постраничной навигации.", _
        "Карточки заявок – компактное представление информации о заявке с возможностью быстрого доступа к основным действиям.", _
        "Формы с валидацией – интерактивные формы для ввода и редактирования данных с проверкой корректности вводимой информации.", _
        "Выпадающие списки – для выбора значений из предопределенного набора (статусы, категории, теги).", _
        "Индикаторы состояния – цветовое и графическое отображение статусов заявок и других важных параметров.", _
        "Система уведомлений – информирование пользователя о важных событиях через всплывающие сообщения.", _
        "Drag-and-drop интерфейс – для интуитивного управления заявками (например, перемещение между статусами).")

    ' Добавление подзаголовка: Адаптивность интерфейса
    textИнтерфейс1 = "3. Адаптивность интерфейса" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание адаптивности интерфейса
    textИнтерфейс1 = "Интерфейс мини-CRM модуля разработан с учетом требований адаптивности и обеспечивает "
    textИнтерфейс2 = "корректное отображение на различных устройствах:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2

    ' Добавление маркированного списка особенностей адаптивности
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Отзывчивый дизайн на основе Bootstrap Grid – автоматическое изменение расположения элементов в зависимости от размера экрана.", _
        "Мобильная версия интерфейса – оптимизированное представление для использования на смартфонах и планшетах.", _
        "Упрощенный режим отображения – возможность скрытия второстепенной информации для работы на устройствах с небольшим экраном.", _
        "Оптимизация для тактильного управления – увеличенные области взаимодействия для удобного использования на сенсорных экранах.")

    ' Пример интерфейса
    textИнтерфейс1 = "На рисунке 2.8 представлен пример интерфейса мини-CRM модуля системы LeadFlow Analytics." & vbCr

    Selection.TypeText textИнтерфейс1
    ДобавитьРисунокЗаглушку docTarget, "Интерфейс мини-CRM модуля системы LeadFlow Analytics"

    ' Добавление подзаголовка: Пользовательские сценарии
    textИнтерфейс1 = "4. Пользовательские сценарии" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.Font.Bold = True
    Selection.TypeParagraph
    Selection.Font.Bold = False

    ' Описание пользовательских сценариев
    textИнтерфейс1 = "При разработке интерфейса были учтены основные пользовательские сценарии, "
    textИнтерфейс2 = "которые определили организацию элементов и навигационную структуру:" & vbCr

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2

    ' Добавление маркированного списка пользовательских сценариев
    ДобавитьМаркированныйСписок docTarget, Array( _
        "Сценарий обработки новой заявки: просмотр → принятие в работу → коммуникация с клиентом → изменение статуса → завершение.", _
        "Сценарий поиска и фильтрации заявок: установка фильтров → просмотр результатов → открытие детальной информации.", _
        "Сценарий работы с клиентской базой: поиск клиента → просмотр истории взаимодействия → добавление комментария → обновление информации.", _
        "Сценарий аналитики: выбор временного периода → просмотр ключевых метрик → детализация по интересующим параметрам → экспорт отчета.")

    ' Заключительный текст
    textИнтерфейс1 = "Разработанный интерфейс мини-CRM модуля системы LeadFlow Analytics обеспечивает "
    textИнтерфейс2 = "эффективное взаимодействие пользователей с системой, интуитивно понятную навигацию и "
    textИнтерфейс3 = "доступ ко всем функциональным возможностям. Интерфейс соответствует современным "
    textИнтерфейс4 = "тенденциям в области UX/UI дизайна и обеспечивает высокую производительность при "
    textИнтерфейс5 = "выполнении типовых операций по управлению клиентскими заявками."

    Selection.TypeText textИнтерфейс1
    Selection.TypeText textИнтерфейс2
    Selection.TypeText textИнтерфейс3
    Selection.TypeText textИнтерфейс4
    Selection.TypeText textИнтерфейс5
    Selection.TypeParagraph
End Sub